---
title: 內容傳遞網路指導
titleSuffix: Best practices for cloud applications
description: 使用內容傳遞網路 (CDN) 的指引，目的是傳遞 Azure 中裝載的高頻寬內容。
author: dragon119
ms.date: 02/02/2018
ms.topic: best-practice
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.custom: seodec18
ms.openlocfilehash: f4ffe9c5cdd7a53ab8359ef303076c5e53e9e45c
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/20/2019
ms.locfileid: "58249103"
---
# <a name="content-delivery-networks-cdns"></a><span data-ttu-id="a9da1-103">內容傳遞網路 (CDN)</span><span class="sxs-lookup"><span data-stu-id="a9da1-103">Content delivery networks (CDNs)</span></span>

<span data-ttu-id="a9da1-104">內容傳遞網路 (CDN) 是可以有效率地將 Web 內容傳遞給使用者的分散式伺服器網路。</span><span class="sxs-lookup"><span data-stu-id="a9da1-104">A content delivery network (CDN) is a distributed network of servers that can efficiently deliver web content to users.</span></span> <span data-ttu-id="a9da1-105">CDN 會將快取的內容儲存在使用者附近的邊緣伺服器，以將延遲降至最低。</span><span class="sxs-lookup"><span data-stu-id="a9da1-105">CDNs store cached content on edge servers that are close to end-users, to minimize latency.</span></span>

<span data-ttu-id="a9da1-106">CDN 通常用來傳遞靜態內容，例如影像、樣式表、文件、檔案、用戶端指令碼和 HTML 頁面。</span><span class="sxs-lookup"><span data-stu-id="a9da1-106">CDNs are typically used to deliver static content such as images, style sheets, documents, client-side scripts, and HTML pages.</span></span> <span data-ttu-id="a9da1-107">使用 CDN 的主要優點是較低的延遲及更快將內容傳遞給使用者，而與裝載應用程式的資料中心的地理位置無關。</span><span class="sxs-lookup"><span data-stu-id="a9da1-107">The major advantages of using a CDN are lower latency and faster delivery of content to users, regardless of their geographical location in relation to the datacenter where the application is hosted.</span></span> <span data-ttu-id="a9da1-108">CDN 也有助於降低 Web 應用程式的負載，因為此類應用程式不需要處理對 CDN 所裝載的內容提出的要求。</span><span class="sxs-lookup"><span data-stu-id="a9da1-108">CDNs can also help to reduce load on a web application, because the application does not have to service requests for the content that is hosted in the CDN.</span></span>

![CDN 圖表](./images/cdn/CDN.png)

<span data-ttu-id="a9da1-110">在 Azure 中，[Azure 內容傳遞網路](/azure/cdn/cdn-overview)是一個全域 CDN 解決方案，可提供裝載在 Azure 或任何其他位置中的高頻寬內容。</span><span class="sxs-lookup"><span data-stu-id="a9da1-110">In Azure, the [Azure Content Delivery Network](/azure/cdn/cdn-overview) is a global CDN solution for delivering high-bandwidth content that is hosted in Azure or any other location.</span></span> <span data-ttu-id="a9da1-111">使用 Azure CDN 可讓您快取從 Azure Blob 儲存體、Web 應用程式、虛擬機器、任何可公開存取的 Web 伺服器載入的公用物件。</span><span class="sxs-lookup"><span data-stu-id="a9da1-111">Using Azure CDN, you can cache publicly available objects loaded from Azure blob storage, a web application, virtual machine, any publicly accessible web server.</span></span>

<span data-ttu-id="a9da1-112">本主題說明使用 CDN 時的一般最佳作法和考量事項。</span><span class="sxs-lookup"><span data-stu-id="a9da1-112">This topic describes some general best practices and considerations when using a CDN.</span></span> <span data-ttu-id="a9da1-113">如需詳細資訊，請參閱 [Azure CDN](/azure/cdn/)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-113">For more information, see [Azure CDN](/azure/cdn/).</span></span>

## <a name="how-and-why-a-cdn-is-used"></a><span data-ttu-id="a9da1-114">如何及為何使用 CDN</span><span class="sxs-lookup"><span data-stu-id="a9da1-114">How and why a CDN is used</span></span>

<span data-ttu-id="a9da1-115">CDN 的典型用法包括：</span><span class="sxs-lookup"><span data-stu-id="a9da1-115">Typical uses for a CDN include:</span></span>  

- <span data-ttu-id="a9da1-116">傳遞用戶端應用程式的靜態資源，通常是來自網站。</span><span class="sxs-lookup"><span data-stu-id="a9da1-116">Delivering static resources for client applications, often from a website.</span></span> <span data-ttu-id="a9da1-117">這些資源可以是映像、樣式表、文件、檔案、用戶端指令碼、HTML 頁面、HTML 片段，或伺服器不需要為每個要求修改的任何其他內容。</span><span class="sxs-lookup"><span data-stu-id="a9da1-117">These resources can be images, style sheets, documents, files, client-side scripts, HTML pages, HTML fragments, or any other content that the server does not need to modify for each request.</span></span> <span data-ttu-id="a9da1-118">應用程式可在執行階段建立項目，並讓 CDN 使用它們 (例如，藉由建立目前頭條新聞清單)，但它不會為每個要求這麼做。</span><span class="sxs-lookup"><span data-stu-id="a9da1-118">The application can create items at runtime and make them available to the CDN (for example, by creating a list of current news headlines), but it does not do so for each request.</span></span>

- <span data-ttu-id="a9da1-119">將公用靜態和共用內容傳遞給裝置，例如行動電話和平板電腦。</span><span class="sxs-lookup"><span data-stu-id="a9da1-119">Delivering public static and shared content to devices such as mobile phones and tablet computers.</span></span> <span data-ttu-id="a9da1-120">應用程式本身是一個 Web 服務，可將 API 提供給執行於各種裝置的用戶端。</span><span class="sxs-lookup"><span data-stu-id="a9da1-120">The application itself is a web service that offers an API to clients running on the various devices.</span></span> <span data-ttu-id="a9da1-121">CDN 也可以傳遞靜態資料集 (透過 Web 服務) 供用戶端使用，或許用來產生用戶端 UI。</span><span class="sxs-lookup"><span data-stu-id="a9da1-121">The CDN can also deliver static datasets (via the web service) for the clients to use, perhaps to generate the client UI.</span></span> <span data-ttu-id="a9da1-122">例如，CDN 可用來散發 JSON 或 XML 文件。</span><span class="sxs-lookup"><span data-stu-id="a9da1-122">For example, the CDN could be used to distribute JSON or XML documents.</span></span>

- <span data-ttu-id="a9da1-123">讓用戶端使用僅包含公用靜態內容的整個網站，而不需要任何專用的計算資源。</span><span class="sxs-lookup"><span data-stu-id="a9da1-123">Serving entire websites that consist of only public static content to clients, without requiring any dedicated compute resources.</span></span>

- <span data-ttu-id="a9da1-124">視需要將視訊檔案串流到用戶端。</span><span class="sxs-lookup"><span data-stu-id="a9da1-124">Streaming video files to the client on demand.</span></span> <span data-ttu-id="a9da1-125">視訊可從提供 CDN 連接的全球資料中心，獲得低延遲和可靠連線的好處。</span><span class="sxs-lookup"><span data-stu-id="a9da1-125">Video benefits from the low latency and reliable connectivity available from the globally located datacenters that offer CDN connections.</span></span> <span data-ttu-id="a9da1-126">Microsoft Azure 媒體服務 (AMS) 會與 Azure CDN 整合，直接提供內容給 CDN，以進行進一步的發佈。</span><span class="sxs-lookup"><span data-stu-id="a9da1-126">Microsoft Azure Media Services (AMS) integrates with Azure CDN to deliver content directly to the CDN for further distribution.</span></span> <span data-ttu-id="a9da1-127">如需詳細資訊，請參閱[串流端點概觀](/azure/media-services/media-services-streaming-endpoints-overview)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-127">For more information, see [Streaming endpoints overview](/azure/media-services/media-services-streaming-endpoints-overview).</span></span>

- <span data-ttu-id="a9da1-128">一般可改善使用者體驗，特別是與裝載應用程式的資料中心相距較遠的使用者。</span><span class="sxs-lookup"><span data-stu-id="a9da1-128">Generally improving the experience for users, especially those located far from the datacenter hosting the application.</span></span> <span data-ttu-id="a9da1-129">這些使用者可能會遭遇到較高的延遲。</span><span class="sxs-lookup"><span data-stu-id="a9da1-129">These users might otherwise suffer higher latency.</span></span> <span data-ttu-id="a9da1-130">Web 應用程式中內容的總大小大都是靜態的，且使用 CDN 有助於維護效能和整體使用者體驗，同時不需要將應用程式部署到多個資料中心。</span><span class="sxs-lookup"><span data-stu-id="a9da1-130">A large proportion of the total size of the content in a web application is often static, and using the CDN can help to maintain performance and overall user experience while eliminating the requirement to deploy the application to multiple data centers.</span></span> <span data-ttu-id="a9da1-131">如需 Azure CDN 節點位置清單，請參閱 [Azure CDN POP 位置](/azure/cdn/cdn-pop-locations/)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-131">For a list of Azure CDN node locations, see [Azure CDN POP Locations](/azure/cdn/cdn-pop-locations/).</span></span>

- <span data-ttu-id="a9da1-132">支援 IoT (物聯網) 解決方案。</span><span class="sxs-lookup"><span data-stu-id="a9da1-132">Supporting IoT (Internet of Things) solutions.</span></span> <span data-ttu-id="a9da1-133">如果需要直接將韌體更新散發到每個裝置，與 IoT 解決方案有關的裝置和設備數量極為龐大，可能會輕易導致應用程式無法因應。</span><span class="sxs-lookup"><span data-stu-id="a9da1-133">The huge numbers of devices and appliances involved in an IoT solution could easily overwhelm an application if it had to distribute firmware updates directly to each device.</span></span>

- <span data-ttu-id="a9da1-134">處理尖峰和偶發性需求而不需應用程式調整，避免後續增加營運成本。</span><span class="sxs-lookup"><span data-stu-id="a9da1-134">Coping with peaks and surges in demand without requiring the application to scale, avoiding the consequent increased running costs.</span></span> <span data-ttu-id="a9da1-135">例如，針對硬體裝置 (例如特定型號的路由器) 或消費性裝置 (例如智慧型電視) 發行作業系統的更新時，如果數以百萬的使用者和裝置在短期間內下載更新，則可能會視需要產生龐大的尖峰量。</span><span class="sxs-lookup"><span data-stu-id="a9da1-135">For example, when an update to an operating system is released for a hardware device such as a specific model of router, or for a consumer device such as a smart TV, there will be a huge peak in demand as it is downloaded by millions of users and devices over a short period.</span></span>

## <a name="challenges"></a><span data-ttu-id="a9da1-136">挑戰</span><span class="sxs-lookup"><span data-stu-id="a9da1-136">Challenges</span></span>

<span data-ttu-id="a9da1-137">計劃使用 CDN 時必須考量幾項挑戰。</span><span class="sxs-lookup"><span data-stu-id="a9da1-137">There are several challenges to take into account when planning to use a CDN.</span></span>

- <span data-ttu-id="a9da1-138">**部署**。</span><span class="sxs-lookup"><span data-stu-id="a9da1-138">**Deployment**.</span></span> <span data-ttu-id="a9da1-139">決定 CDN 將從中提取內容的原點，及是否需要將內容部署到多個儲存體系統中。</span><span class="sxs-lookup"><span data-stu-id="a9da1-139">Decide the origin from which the CDN fetches the content, and whether you need to deploy the content in more than one storage system.</span></span> <span data-ttu-id="a9da1-140">請將部署靜態內容和資源的程序納入考量。</span><span class="sxs-lookup"><span data-stu-id="a9da1-140">Take into account the process for deploying static content and resources.</span></span> <span data-ttu-id="a9da1-141">比方說，您可能需要實作個別的步驟，才能將內容載入 Azure blob 儲存體。</span><span class="sxs-lookup"><span data-stu-id="a9da1-141">For example, you may need to implement a separate step to load content into Azure blob storage.</span></span>

- <span data-ttu-id="a9da1-142">**版本控制和快取控制**。</span><span class="sxs-lookup"><span data-stu-id="a9da1-142">**Versioning and cache-control**.</span></span> <span data-ttu-id="a9da1-143">考慮如何更新靜態內容和部署新版本。</span><span class="sxs-lookup"><span data-stu-id="a9da1-143">Consider how you will update static content and deploy new versions.</span></span> <span data-ttu-id="a9da1-144">請了解 CDN 執行快取和存留時間 (TTL) 的方式。</span><span class="sxs-lookup"><span data-stu-id="a9da1-144">Understand how the CDN performs caching and time-to-live (TTL).</span></span> <span data-ttu-id="a9da1-145">如需 Azure CDN 的相關資訊，請參閱[快取的運作方式](/azure/cdn/cdn-how-caching-works)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-145">For Azure CDN, see [How caching works](/azure/cdn/cdn-how-caching-works).</span></span>

- <span data-ttu-id="a9da1-146">**測試**。</span><span class="sxs-lookup"><span data-stu-id="a9da1-146">**Testing**.</span></span> <span data-ttu-id="a9da1-147">在本機或在預備環境中開發和測試應用程式時，很難為 CDN 設定執行本機測試。</span><span class="sxs-lookup"><span data-stu-id="a9da1-147">It can be difficult to perform local testing of your CDN settings when developing and testing an application locally or in a staging environment.</span></span>

- <span data-ttu-id="a9da1-148">**搜尋引擎最佳化 (SEO)**。</span><span class="sxs-lookup"><span data-stu-id="a9da1-148">**Search engine optimization (SEO)**.</span></span> <span data-ttu-id="a9da1-149">當您使用 CDN 時，如影像和文件等內容皆由不同的網域服務。</span><span class="sxs-lookup"><span data-stu-id="a9da1-149">Content such as images and documents are served from a different domain when you use the CDN.</span></span> <span data-ttu-id="a9da1-150">這可能會影響此內容的 SEO。</span><span class="sxs-lookup"><span data-stu-id="a9da1-150">This can have an effect on SEO for this content.</span></span>

- <span data-ttu-id="a9da1-151">**內容安全性**。</span><span class="sxs-lookup"><span data-stu-id="a9da1-151">**Content security**.</span></span> <span data-ttu-id="a9da1-152">並非所有的 CDN 皆提供任何形式的內容存取控制。</span><span class="sxs-lookup"><span data-stu-id="a9da1-152">Not all CDNs offer any form of access control for the content.</span></span> <span data-ttu-id="a9da1-153">有些 CDN 服務 (包括 Azure CDN) 支援以權杖型驗證保護 CDN 內容。</span><span class="sxs-lookup"><span data-stu-id="a9da1-153">Some CDN services, including Azure CDN, support token-based authentication to protect CDN content.</span></span> <span data-ttu-id="a9da1-154">如需詳細資訊，請參閱[使用權杖驗證來保護 Azure 內容傳遞網路資產](/azure/cdn/cdn-token-auth)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-154">For more information, see [Securing Azure Content Delivery Network assets with token authentication](/azure/cdn/cdn-token-auth).</span></span>

- <span data-ttu-id="a9da1-155">**用戶端安全性**。</span><span class="sxs-lookup"><span data-stu-id="a9da1-155">**Client security**.</span></span> <span data-ttu-id="a9da1-156">用戶端可從不允許存取 CDN 上資源的環境中連接。</span><span class="sxs-lookup"><span data-stu-id="a9da1-156">Clients might connect from an environment that does not allow access to resources on the CDN.</span></span> <span data-ttu-id="a9da1-157">這可能是安全性限制的環境，限制只能存取一組已知來源，或防止從原始頁面以外的任何位置載入資源的環境。</span><span class="sxs-lookup"><span data-stu-id="a9da1-157">This could be a security-constrained environment that limits access to only a set of known sources, or one that prevents loading of resources from anything other than the page origin.</span></span> <span data-ttu-id="a9da1-158">需要後援實作，才能處理這些情況。</span><span class="sxs-lookup"><span data-stu-id="a9da1-158">A fallback implementation is required to handle these cases.</span></span>

- <span data-ttu-id="a9da1-159">**恢復功能**。</span><span class="sxs-lookup"><span data-stu-id="a9da1-159">**Resilience**.</span></span> <span data-ttu-id="a9da1-160">CDN 是應用程式的潛在單一失敗點。</span><span class="sxs-lookup"><span data-stu-id="a9da1-160">The CDN is a potential single point of failure for an application.</span></span>

<span data-ttu-id="a9da1-161">CDN 較沒有用的案例括：</span><span class="sxs-lookup"><span data-stu-id="a9da1-161">Scenarios where CDN may be less useful include:</span></span>  

- <span data-ttu-id="a9da1-162">如果內容點擊率偏低，該內容在有效期間 (由其存留時間設定值決定) 可能僅被存取數次。</span><span class="sxs-lookup"><span data-stu-id="a9da1-162">If the content has a low hit rate, it might be accessed only few times while it is valid (determined by its time-to-live setting).</span></span>

- <span data-ttu-id="a9da1-163">如果資料是私人的，例如適用於大型企業或供應鏈生態系統。</span><span class="sxs-lookup"><span data-stu-id="a9da1-163">If the data is private, such as for large enterprises or supply chain ecosystems.</span></span>

## <a name="general-guidelines-and-good-practices"></a><span data-ttu-id="a9da1-164">一般方針和最佳做法</span><span class="sxs-lookup"><span data-stu-id="a9da1-164">General guidelines and good practices</span></span>

<span data-ttu-id="a9da1-165">使用 CDN 是最小化應用程式負載，及最大化可用性與效能的好方法。</span><span class="sxs-lookup"><span data-stu-id="a9da1-165">Using a CDN is a good way to minimize the load on your application, and maximize availability and performance.</span></span> <span data-ttu-id="a9da1-166">為應用程式使用的所有適當內容和資源，考慮採用此策略。</span><span class="sxs-lookup"><span data-stu-id="a9da1-166">Consider adopting this strategy for all of the appropriate content and resources your application uses.</span></span> <span data-ttu-id="a9da1-167">設計使用 CDN 的策略時，請考量以下幾節中的要點。</span><span class="sxs-lookup"><span data-stu-id="a9da1-167">Consider the points in the following sections when designing your strategy to use a CDN.</span></span>

### <a name="deployment"></a><span data-ttu-id="a9da1-168">部署</span><span class="sxs-lookup"><span data-stu-id="a9da1-168">Deployment</span></span>

<span data-ttu-id="a9da1-169">如果您未在應用程式部署封裝或程序中包含靜態內容，該靜態內容可能需要與應用程式分開佈建和部署。</span><span class="sxs-lookup"><span data-stu-id="a9da1-169">Static content may need to be provisioned and deployed independently from the application if you do not include it in the application deployment package or process.</span></span> <span data-ttu-id="a9da1-170">請思考這會如何影響版本控制方法，也就是您用於管理應用程式元件和靜態資源內容的方法。</span><span class="sxs-lookup"><span data-stu-id="a9da1-170">Consider how this will affect the versioning approach you use to manage both the application components and the static resource content.</span></span>

<span data-ttu-id="a9da1-171">請考慮使用統合和縮製技術，以縮短用戶端的載入時間。</span><span class="sxs-lookup"><span data-stu-id="a9da1-171">Consider using bundling and minification techniques to reduce load times for clients.</span></span> <span data-ttu-id="a9da1-172">統合可將多個檔案合併成單一檔案。</span><span class="sxs-lookup"><span data-stu-id="a9da1-172">Bundling combines multiple files into a single file.</span></span> <span data-ttu-id="a9da1-173">縮製可在不變更功能的情況下，從指令碼和 CSS 檔案中移除非必要的字元。</span><span class="sxs-lookup"><span data-stu-id="a9da1-173">Minification removes unnecessary characters from scripts and CSS files without altering functionality.</span></span>

<span data-ttu-id="a9da1-174">如果您需要將內容部署到其他位置，這會是部署程序中的額外步驟。</span><span class="sxs-lookup"><span data-stu-id="a9da1-174">If you need to deploy the content to an additional location, this will be an extra step in the deployment process.</span></span> <span data-ttu-id="a9da1-175">如果應用程式更新 CDN 的內容 (或許是固定間隔或為了回應事件)，它必須將更新的內容儲存於任何其他位置，以及 CDN 的端點。</span><span class="sxs-lookup"><span data-stu-id="a9da1-175">If the application updates the content for the CDN, perhaps at regular intervals or in response to an event, it must store the updated content in any additional locations as well as the endpoint for the CDN.</span></span>

<span data-ttu-id="a9da1-176">請考量在預期 CDN 會提供部分靜態內容時，您應如何處理本機開發和測試。</span><span class="sxs-lookup"><span data-stu-id="a9da1-176">Consider how you will handle local development and testing when some static content is expected to be served from a CDN.</span></span> <span data-ttu-id="a9da1-177">例如，您可以將內容預先部署至 CDN，作為建置指令碼的一部分。</span><span class="sxs-lookup"><span data-stu-id="a9da1-177">For example, you could pre-deploy the content to the CDN as part of your build script.</span></span> <span data-ttu-id="a9da1-178">或者，您可以使用編譯指示詞或旗標，控制應用程式載入資源的方式。</span><span class="sxs-lookup"><span data-stu-id="a9da1-178">Alternatively, use compile directives or flags to control how the application loads the resources.</span></span> <span data-ttu-id="a9da1-179">例如，在偵錯模式中，應用程式可能會從本機資料夾載入靜態資源。</span><span class="sxs-lookup"><span data-stu-id="a9da1-179">For example, in debug mode, the application could load static resources from a local folder.</span></span> <span data-ttu-id="a9da1-180">在發行模式中，應用程式會使用 CDN。</span><span class="sxs-lookup"><span data-stu-id="a9da1-180">In release mode, the application would use the CDN.</span></span>

<span data-ttu-id="a9da1-181">請考慮使用檔案壓縮的選項，例如 gzip (GNU zip)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-181">Consider the options for file compression, such as gzip (GNU zip).</span></span> <span data-ttu-id="a9da1-182">壓縮可在來源伺服器上由裝載的 Web 應用程式執行，或是直接在邊緣伺服器上由 CDN 執行。</span><span class="sxs-lookup"><span data-stu-id="a9da1-182">Compression may be performed on the origin server by the web application hosting or directly on the edge servers by the CDN.</span></span> <span data-ttu-id="a9da1-183">如需詳細資訊，請參閱[在 Azure CDN 中壓縮檔案以改善效能](/azure/cdn/cdn-improve-performance)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-183">For more information, see [Improve performance by compressing files in Azure CDN](/azure/cdn/cdn-improve-performance).</span></span>

### <a name="routing-and-versioning"></a><span data-ttu-id="a9da1-184">路由和版本控制</span><span class="sxs-lookup"><span data-stu-id="a9da1-184">Routing and versioning</span></span>

<span data-ttu-id="a9da1-185">您可能需要在不同時間使用不同的 CDN 執行個體。</span><span class="sxs-lookup"><span data-stu-id="a9da1-185">You may need to use different CDN instances at various times.</span></span> <span data-ttu-id="a9da1-186">例如，當您部署新版的應用程式時，可能會想要使用新的 CDN，並保留舊的 CDN (以適用於舊版的舊格式保存內容)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-186">For example, when you deploy a new version of the application you may want to use a new CDN and retain the old CDN (holding content in an older format) for previous versions.</span></span> <span data-ttu-id="a9da1-187">如果您將 Azure Blob 儲存體作為內容的原點，可以建立個別的儲存體帳戶或個別的容器，並將 CDN 端點指向它。</span><span class="sxs-lookup"><span data-stu-id="a9da1-187">If you use Azure blob storage as the content origin, you can create a separate storage account or a separate container and point the CDN endpoint to it.</span></span>

<span data-ttu-id="a9da1-188">請勿使用查詢字串來表示 CDN 上資源連結中不同版本的應用程式，因為從 Azure Blob 儲存體擷取內容時，查詢字串為資源名稱 (Blob 名稱) 的一部分。</span><span class="sxs-lookup"><span data-stu-id="a9da1-188">Do not use the query string to denote different versions of the application in links to resources on the CDN because, when retrieving content from Azure blob storage, the query string is part of the resource name (the blob name).</span></span> <span data-ttu-id="a9da1-189">此方法也會影響用戶端快取資源的方式。</span><span class="sxs-lookup"><span data-stu-id="a9da1-189">This approach can also affect how the client caches resources.</span></span>

<span data-ttu-id="a9da1-190">若是在 CDN 上快取先前的資源，則在部署新版本的靜態內容時，更新應用程式可能是一項挑戰。</span><span class="sxs-lookup"><span data-stu-id="a9da1-190">Deploying new versions of static content when you update an application can be a challenge if the previous resources are cached on the CDN.</span></span> <span data-ttu-id="a9da1-191">如需詳細資訊，請參閱以下與快取控制有關的小節。</span><span class="sxs-lookup"><span data-stu-id="a9da1-191">For more information, see the section on cache control, below.</span></span>

<span data-ttu-id="a9da1-192">請考慮依國家/地區限制 CDN 內容存取。</span><span class="sxs-lookup"><span data-stu-id="a9da1-192">Consider restricting the CDN content access by country.</span></span> <span data-ttu-id="a9da1-193">Azure CDN 可以讓您根據來源的國家/地區來篩選要求，並限制傳遞的內容。</span><span class="sxs-lookup"><span data-stu-id="a9da1-193">Azure CDN allows you to filter requests based on the country of origin and restrict the content delivered.</span></span> <span data-ttu-id="a9da1-194">如需詳細資訊，請參閱[依國家/地區限制對內容的存取](/azure/cdn/cdn-restrict-access-by-country/)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-194">For more information, see [Restrict access to your content by country](/azure/cdn/cdn-restrict-access-by-country/).</span></span>

### <a name="cache-control"></a><span data-ttu-id="a9da1-195">快取控制</span><span class="sxs-lookup"><span data-stu-id="a9da1-195">Cache control</span></span>

<span data-ttu-id="a9da1-196">請考量如何管理系統內的快取。</span><span class="sxs-lookup"><span data-stu-id="a9da1-196">Consider how to manage caching within the system.</span></span> <span data-ttu-id="a9da1-197">例如，在 Azure CDN 中，您可以設定全域快取規則，然後為特定的來源端點設定自訂快取。</span><span class="sxs-lookup"><span data-stu-id="a9da1-197">For example, in Azure CDN, you can set global caching rules, and then set custom caching for particular origin endpoints.</span></span> <span data-ttu-id="a9da1-198">您也可以在來源傳送快取指示詞標頭，以控制在 CDN 中執行快取的方式。</span><span class="sxs-lookup"><span data-stu-id="a9da1-198">You can also control how caching is performed in a CDN by sending cache-directive headers at the origin.</span></span>

<span data-ttu-id="a9da1-199">如需詳細資訊，請參閱[快取的運作方式](/azure/cdn/cdn-how-caching-works)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-199">For more information, see [How caching works](/azure/cdn/cdn-how-caching-works).</span></span>

<span data-ttu-id="a9da1-200">若要防止在 CDN 上使用物件，您可以從來源加以刪除、移除或刪除 CDN 端點，或在使用 Blob 儲存體的情況下，讓容器或 Blob 變成私用。</span><span class="sxs-lookup"><span data-stu-id="a9da1-200">To prevent objects from being available on the CDN, you can delete them from the origin, remove or delete the CDN endpoint, or in the case of blob storage, make the container or blob private.</span></span> <span data-ttu-id="a9da1-201">不過，只有在存留時間到期後，才會移除項目。</span><span class="sxs-lookup"><span data-stu-id="a9da1-201">However, items are not removed from the until the time-to-live expires.</span></span> <span data-ttu-id="a9da1-202">您也可以手動清除 CDN 端點。</span><span class="sxs-lookup"><span data-stu-id="a9da1-202">You can also manually purge a CDN endpoint.</span></span>

### <a name="security"></a><span data-ttu-id="a9da1-203">安全性</span><span class="sxs-lookup"><span data-stu-id="a9da1-203">Security</span></span>

<span data-ttu-id="a9da1-204">CDN 可以使用 CDN 所提供的憑證，透過 HTTPS (SSL) 傳遞內容，也可以透過 HTTP。</span><span class="sxs-lookup"><span data-stu-id="a9da1-204">The CDN can deliver content over HTTPS (SSL), by using the certificate provided by the CDN, as well as over standard HTTP.</span></span> <span data-ttu-id="a9da1-205">為了避免瀏覽器發出混合內容警告，您最好使用 HTTPS，要求透過 HTTPS 載入的頁面所顯示的靜態內容。</span><span class="sxs-lookup"><span data-stu-id="a9da1-205">To avoid browser warnings about mixed content, you might need to use HTTPS to request static content that is displayed in pages loaded through HTTPS.</span></span>

<span data-ttu-id="a9da1-206">使用 CDN 傳遞靜態資產時 (如字型檔案)，如果使用 *XMLHttpRequest* 呼叫要求不同網域中的這些資源，可能會遇到相同來源原則問題。</span><span class="sxs-lookup"><span data-stu-id="a9da1-206">If you deliver static assets such as font files by using the CDN, you might encounter same-origin policy issues if you use an *XMLHttpRequest* call to request these resources from a different domain.</span></span> <span data-ttu-id="a9da1-207">許多網頁瀏覽器會防止跨原始來源資源分享 (CORS)，除非網頁伺服器已設定適當的回應標頭。</span><span class="sxs-lookup"><span data-stu-id="a9da1-207">Many web browsers prevent cross-origin resource sharing (CORS) unless the web server is configured to set the appropriate response headers.</span></span> <span data-ttu-id="a9da1-208">使用下列方法之一可以設定 CDN 支援 CORS：</span><span class="sxs-lookup"><span data-stu-id="a9da1-208">You can configure the CDN to support CORS by using one of the following methods:</span></span>

- <span data-ttu-id="a9da1-209">使用 CDN 以將 CORS 標頭新增至回應。</span><span class="sxs-lookup"><span data-stu-id="a9da1-209">Configure the CDN to add CORS headers to the responses.</span></span> <span data-ttu-id="a9da1-210">如需詳細資訊，請參閱[搭配使用 Azure CDN 與 CORS](/azure/cdn/cdn-cors)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-210">For more information, see [Using Azure CDN with CORS](/azure/cdn/cdn-cors).</span></span>

- <span data-ttu-id="a9da1-211">如果來源是 Azure Blob 儲存體，請將 CORS 規則新增至儲存體端點。</span><span class="sxs-lookup"><span data-stu-id="a9da1-211">If the origin is Azure blob storage, add CORS rules to the storage endpoint.</span></span> <span data-ttu-id="a9da1-212">如需詳細資訊，請參閱 [跨原始資源共用 (CORS) 支援 Azure 儲存體服務](/rest/api/storageservices/Cross-Origin-Resource-Sharing--CORS--Support-for-the-Azure-Storage-Services)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-212">For more information, see [Cross-Origin Resource Sharing (CORS) Support for the Azure Storage Services](/rest/api/storageservices/Cross-Origin-Resource-Sharing--CORS--Support-for-the-Azure-Storage-Services).</span></span>

- <span data-ttu-id="a9da1-213">設定應用程式以設定 CORS 標頭。</span><span class="sxs-lookup"><span data-stu-id="a9da1-213">Configure the application to set the CORS headers.</span></span> <span data-ttu-id="a9da1-214">如需範例，請參閱 ASP.NET Core 文件中的[啟用跨源要求 (CORS)](/aspnet/core/security/cors)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-214">For example, see [Enabling Cross-Origin Requests (CORS)](/aspnet/core/security/cors) in the ASP.NET Core documentation.</span></span>

### <a name="cdn-fallback"></a><span data-ttu-id="a9da1-215">CDN 後援</span><span class="sxs-lookup"><span data-stu-id="a9da1-215">CDN fallback</span></span>

<span data-ttu-id="a9da1-216">考量應用程式如何處理 CDN 失敗或暫時無法使用。</span><span class="sxs-lookup"><span data-stu-id="a9da1-216">Consider how your application will cope with a failure or temporary unavailability of the CDN.</span></span> <span data-ttu-id="a9da1-217">如果無法使用 CDN，用戶端應用程式可使用前一個要求期間的本機快取資源複本 (位於用戶端)，或者可以加入程式碼來偵測失敗，而非從原點要求資源 (應用程式資料夾或佔用資源的 Azure Blob 容器)。</span><span class="sxs-lookup"><span data-stu-id="a9da1-217">Client applications may be able to use copies of the resources that were cached locally (on the client) during previous requests, or you can include code that detects failure and instead requests resources from the origin (the application folder or Azure blob container that holds the resources) if the CDN is unavailable.</span></span>
