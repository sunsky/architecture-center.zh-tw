---
title: 從 Azure 區域遺失中復原
description: 了解和設計復原性、高可用性、容錯的應用程式及規劃災害復原。
author: adamglick
ms.date: 08/18/2016
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.custom: resiliency
ms.openlocfilehash: 7f207bbc0bb0128126f9b828dc100d43553cb100
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/20/2019
ms.locfileid: "58242709"
---
[!INCLUDE [header](../_includes/header.md)]

# <a name="azure-resiliency-technical-guidance-recovery-from-a-region-wide-service-disruption"></a><span data-ttu-id="1a5f2-103">Azure 復原技術指導：從全區域服務中斷復原</span><span class="sxs-lookup"><span data-stu-id="1a5f2-103">Azure resiliency technical guidance: recovery from a region-wide service disruption</span></span>

<span data-ttu-id="1a5f2-104">Azure 在實體和邏輯上劃分單位，稱為區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-104">Azure is divided physically and logically into units called regions.</span></span> <span data-ttu-id="1a5f2-105">區域由一或多個非常接近的資料中心組成。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-105">A region consists of one or more datacenters in close proximity.</span></span>

<span data-ttu-id="1a5f2-106">在罕見的情況下，整個區域內的設施可能變得無法存取 (例如，由於網路故障)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-106">Under rare circumstances, it is possible that facilities in an entire region can become inaccessible, for example due to network failures.</span></span> <span data-ttu-id="1a5f2-107">或者，設施可能完全喪失 (例如，因為天然災害)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-107">Or facilities can be lost entirely, for example due to a natural disaster.</span></span> <span data-ttu-id="1a5f2-108">本節說明 Azure 可用來建立跨區域分散之應用程式的能力。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-108">This section explains the capabilities of Azure for creating applications that are distributed across regions.</span></span> <span data-ttu-id="1a5f2-109">這樣的分散有助於將某個區域失常而波及其他區域的可能性降到最低。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-109">Such distribution helps to minimize the possibility that a failure in one region could affect other regions.</span></span>

## <a name="cloud-services"></a><span data-ttu-id="1a5f2-110">雲端服務</span><span class="sxs-lookup"><span data-stu-id="1a5f2-110">Cloud services</span></span>

### <a name="resource-management"></a><span data-ttu-id="1a5f2-111">資源管理</span><span class="sxs-lookup"><span data-stu-id="1a5f2-111">Resource management</span></span>

<span data-ttu-id="1a5f2-112">您可以將計算執行個體分散至各區域，方法是在每個目標區域建立個別的雲端服務，再將部署封裝發佈至每個雲端服務。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-112">You can distribute compute instances across regions by creating a separate cloud service in each target region, and then publishing the deployment package to each cloud service.</span></span> <span data-ttu-id="1a5f2-113">但請注意，將流量分散到不同區域的雲端服務時，必須由應用程式開發人員實作，或透過流量管理服務來達成。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-113">However, note that distributing traffic across cloud services in different regions must be implemented by the application developer or with a traffic management service.</span></span>

<span data-ttu-id="1a5f2-114">在災害復原之前，先決定可部署的備用角色執行個體數目，是容量規劃的重要一環。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-114">Determining the number of spare role instances to deploy in advance for disaster recovery is an important aspect of capacity planning.</span></span> <span data-ttu-id="1a5f2-115">備妥完整規模的次要部署可確保容量在需要時垂手可得，但這實際上會增加成本。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-115">Having a full-scale secondary deployment ensures that capacity is already available when needed; however, this effectively doubles the cost.</span></span> <span data-ttu-id="1a5f2-116">常見的模式是備妥較小的次要部署，足夠執行關鍵服務即可。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-116">A common pattern is to have a small, secondary deployment, just large enough to run critical services.</span></span> <span data-ttu-id="1a5f2-117">這種小型的次要部署非常適合用來保留容量以及測試次要環境的組態。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-117">This small secondary deployment is a good idea, both to reserve capacity, and for testing the configuration of the secondary environment.</span></span>

> [!NOTE]
> <span data-ttu-id="1a5f2-118">訂用帳戶配額不保證容量。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-118">The subscription quota is not a capacity guarantee.</span></span> <span data-ttu-id="1a5f2-119">配額只是信用額度。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-119">The quota is simply a credit limit.</span></span> <span data-ttu-id="1a5f2-120">若要保證容量，必須在服務模型中定義所需的角色數目，還必須部署角色。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-120">To guarantee capacity, the required number of roles must be defined in the service model, and the roles must be deployed.</span></span>

### <a name="load-balancing"></a><span data-ttu-id="1a5f2-121">負載平衡</span><span class="sxs-lookup"><span data-stu-id="1a5f2-121">Load Balancing</span></span>

<span data-ttu-id="1a5f2-122">若要平衡各區域的流量負載，需要使用流量管理方案。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-122">To load balance traffic across regions requires a traffic management solution.</span></span> <span data-ttu-id="1a5f2-123">Azure 提供 [Azure 流量管理員](https://azure.microsoft.com/services/traffic-manager/)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-123">Azure provides [Azure Traffic Manager](https://azure.microsoft.com/services/traffic-manager/).</span></span> <span data-ttu-id="1a5f2-124">您也可以利用協力廠商服務所提供的類似流量管理功能。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-124">You can also take advantage of third-party services that provide similar traffic management capabilities.</span></span>

### <a name="strategies"></a><span data-ttu-id="1a5f2-125">策略</span><span class="sxs-lookup"><span data-stu-id="1a5f2-125">Strategies</span></span>

<span data-ttu-id="1a5f2-126">有許多不同的策略可實作跨區域的分散式計算。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-126">Many alternative strategies are available for implementing distributed compute across regions.</span></span> <span data-ttu-id="1a5f2-127">這些都必須按照特定的商務需求和應用程式的狀況來量身打造。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-127">These must be tailored to the specific business requirements and circumstances of the application.</span></span> <span data-ttu-id="1a5f2-128">概括而言，這些方法可分為下列類別︰</span><span class="sxs-lookup"><span data-stu-id="1a5f2-128">At a high level, the approaches can be divided into the following categories:</span></span>

- <span data-ttu-id="1a5f2-129">**災害時重新部署**︰在此方法中，發生災害時會從頭開始重新部署應用程式。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-129">**Redeploy on disaster**: In this approach the application is redeployed from scratch at the time of disaster.</span></span> <span data-ttu-id="1a5f2-130">這適用於不需要保證復原時間的非關鍵性應用程式。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-130">This is appropriate for non-critical applications that don’t require a guaranteed recovery time.</span></span>

- <span data-ttu-id="1a5f2-131">**暖備援 (主動/被動)**︰在替代區域建立次要託管服務，並部署角色以保證最起碼的容量，但是角色並不接收生產流量。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-131">**Warm Spare (Active/Passive)**: A secondary hosted service is created in an alternate region, and roles are deployed to guarantee minimal capacity; however, the roles don’t receive production traffic.</span></span> <span data-ttu-id="1a5f2-132">此方法適用於未設計成將流量分散於各區域的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-132">This approach is useful for applications that have not been designed to distribute traffic across regions.</span></span>

- <span data-ttu-id="1a5f2-133">**熱備援 (主動/主動)**：應用程式設計成接收多個區域的生產負載。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-133">**Hot Spare (Active/Active)**: The application is designed to receive production load in multiple regions.</span></span> <span data-ttu-id="1a5f2-134">基於災害復原用途，每個區域的雲端服務可能設定為高於所需的容量。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-134">The cloud services in each region might be configured for higher capacity than required for disaster recovery purposes.</span></span> <span data-ttu-id="1a5f2-135">此外，在災害和容錯移轉時，雲端服務可能視需要而相應放大。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-135">Alternatively, the cloud services might scale out as necessary at the time of a disaster and failover.</span></span> <span data-ttu-id="1a5f2-136">此方法需要大量投注於應用程式設計，但成效顯著。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-136">This approach requires substantial investment in application design, but it has significant benefits.</span></span> <span data-ttu-id="1a5f2-137">這些成效包括較短的保障復原時間、連續測試所有復原位置，以及有效運用容量。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-137">These include low and guaranteed recovery time, continuous testing of all recovery locations, and efficient usage of capacity.</span></span>

<span data-ttu-id="1a5f2-138">分散式設計的完整討論已超出本文的範圍。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-138">A complete discussion of distributed design is outside the scope of this document.</span></span> <span data-ttu-id="1a5f2-139">如需進一步資訊，請參閱 [Azure 應用程式的災害復原與高可用性](https://aka.ms/drtechguide)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-139">For further information, see [Disaster Recovery and High Availability for Azure Applications](https://aka.ms/drtechguide).</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="1a5f2-140">虛擬機器</span><span class="sxs-lookup"><span data-stu-id="1a5f2-140">Virtual machines</span></span>

<span data-ttu-id="1a5f2-141">基礎結構即服務 (IaaS) 虛擬機器 (VM) 的復原在許多方面類似於平台即服務 (PaaS) 計算復原。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-141">Recovery of infrastructure as a service (IaaS) virtual machines (VMs) is similar to platform as a service (PaaS) compute recovery in many respects.</span></span> <span data-ttu-id="1a5f2-142">但由於 IaaS VM 同時包含 VM 和 VM 磁碟，仍有重大的差別。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-142">There are important differences, however, due to the fact that an IaaS VM consists of both the VM and the VM disk.</span></span>

- <span data-ttu-id="1a5f2-143">**使用 Azure 備份建立應用程式一致的跨區域備份**。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-143">**Use Azure Backup to create cross region backups that are application consistent**.</span></span>
  <span data-ttu-id="1a5f2-144">[Azure 備份](https://azure.microsoft.com/services/backup/) 可讓客戶建立跨多個 VM 磁碟的應用程式一致備份，並支援跨區域的備份複寫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-144">[Azure Backup](https://azure.microsoft.com/services/backup/) enables customers to create application consistent backups across multiple VM disks, and support replication of backups across regions.</span></span> <span data-ttu-id="1a5f2-145">建立時選擇異地複寫備份保存庫，即可做到這一切。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-145">You can do this by choosing to geo-replicate the backup vault at the time of creation.</span></span> <span data-ttu-id="1a5f2-146">請注意，建立時就必須設定備份保存庫的複寫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-146">Note that replication of the backup vault must be configured at the time of creation.</span></span> <span data-ttu-id="1a5f2-147">不能在稍後設定。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-147">It can't be set later.</span></span> <span data-ttu-id="1a5f2-148">如果區域遺失，Microsoft 會提供備份給客戶使用。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-148">If a region is lost, Microsoft will make the backups available to customers.</span></span> <span data-ttu-id="1a5f2-149">客戶將能夠還原至任何已設定的還原點。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-149">Customers will be able to restore to any of their configured restore points.</span></span>

- <span data-ttu-id="1a5f2-150">**將資料磁碟與作業系統磁碟隔開**。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-150">**Separate the data disk from the operating system disk**.</span></span> <span data-ttu-id="1a5f2-151">關於 IaaS VM，請注意您必須重新建立 VM，才能變更作業系統磁碟。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-151">An important consideration for IaaS VMs is that you cannot change the operating system disk without re-creating the VM.</span></span> <span data-ttu-id="1a5f2-152">如果您的復原策略是於災害後重新部署，就不會有問題。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-152">This is not a problem if your recovery strategy is to redeploy after disaster.</span></span> <span data-ttu-id="1a5f2-153">不過，如果您使用暖備援方法來保留容量，可能會有問題。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-153">However, it might be a problem if you are using the Warm Spare approach to reserve capacity.</span></span> <span data-ttu-id="1a5f2-154">若要正確實作此方法，您必須將正確的作業系統磁碟部署到主要和次要位置，而且應用程式資料必須儲存在另一個磁碟機。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-154">To implement this properly, you must have the correct operating system disk deployed to both the primary and secondary locations, and the application data must be stored on a separate drive.</span></span> <span data-ttu-id="1a5f2-155">可能的話，請使用兩個位置都可提供的標準作業系統組態。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-155">If possible, use a standard operating system configuration that can be provided on both locations.</span></span> <span data-ttu-id="1a5f2-156">容錯移轉之後，必須再將資料磁碟機附加至次要 DC 內的現有 IaaS VM。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-156">After a failover, you must then attach the data drive to your existing IaaS VMs in the secondary DC.</span></span> <span data-ttu-id="1a5f2-157">使用 AzCopy 將資料磁碟的快照複製到遠端網站。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-157">Use AzCopy to copy snapshots of the data disk(s) to a remote site.</span></span>

- <span data-ttu-id="1a5f2-158">**請留意異地容錯移轉多個 VM 磁碟之後潛在的一致性問題**。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-158">**Be aware of potential consistency issues after a geo-failover of multiple VM Disks**.</span></span> <span data-ttu-id="1a5f2-159">VM 磁碟會實作成 Azure 儲存體 Blob，並具有相同的異地複寫特性。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-159">VM Disks are implemented as Azure Storage blobs, and have the same geo-replication characteristic.</span></span> <span data-ttu-id="1a5f2-160">除非使用 [Azure 備份](https://azure.microsoft.com/services/backup/) ，否則不能保證磁碟之間的一致性，因為異地複寫並非同步，而且會獨立複寫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-160">Unless [Azure Backup](https://azure.microsoft.com/services/backup/) is used, there are no guarantees of consistency across disks, because geo-replication is asynchronous and replicates independently.</span></span> <span data-ttu-id="1a5f2-161">異地容錯移轉後，保證個別 VM 磁碟處於當機時保持一致狀態，但不保證跨磁碟維持一致。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-161">Individual VM disks are guaranteed to be in a crash consistent state after a geo-failover, but not consistent across disks.</span></span> <span data-ttu-id="1a5f2-162">這在某些情況下會造成問題 (例如，磁碟串接的情況)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-162">This could cause problems in some cases (for example, in the case of disk striping).</span></span>

## <a name="storage"></a><span data-ttu-id="1a5f2-163">儲存體</span><span class="sxs-lookup"><span data-stu-id="1a5f2-163">Storage</span></span>

### <a name="recovery-by-using-geo-redundant-storage-of-blob-table-queue-and-vm-disk-storage"></a><span data-ttu-id="1a5f2-164">使用 Blob、資料表、佇列和 VM 磁碟儲存體的異地備援儲存體來復原</span><span class="sxs-lookup"><span data-stu-id="1a5f2-164">Recovery by using Geo-Redundant Storage of blob, table, queue and VM disk storage</span></span>

<span data-ttu-id="1a5f2-165">在 Azure 中，blob、資料表、佇列和 VM 磁碟都預設為異地複寫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-165">In Azure, blobs, tables, queues, and VM disks are all geo-replicated by default.</span></span> <span data-ttu-id="1a5f2-166">這稱為異地備援儲存體 (GRS)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-166">This is referred to as Geo-Redundant Storage (GRS).</span></span> <span data-ttu-id="1a5f2-167">GRS 會將儲存體資料複寫至特定地理區域內數百英哩遠的配對資料中心。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-167">GRS replicates storage data to a paired datacenter hundreds of miles apart within a specific geographic region.</span></span> <span data-ttu-id="1a5f2-168">GRS 目的是在資料中心重大災害情況下提供額外的持久性。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-168">GRS is designed to provide additional durability in case there is a major datacenter disaster.</span></span> <span data-ttu-id="1a5f2-169">Microsoft 會控制容錯移轉時機，只有在確定原始主要位置不可能於合理時間內復原的重大災害下，才會進行容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-169">Microsoft controls when failover occurs, and failover is limited to major disasters in which the original primary location is deemed unrecoverable in a reasonable amount of time.</span></span> <span data-ttu-id="1a5f2-170">在某些情況下，這可能需要好幾天。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-170">Under some scenarios, this can be several days.</span></span> <span data-ttu-id="1a5f2-171">雖然服務等級協定尚未涵蓋同步處理間隔，但通常幾分鐘之內就會複寫資料。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-171">Data is typically replicated within a few minutes, although synchronization interval is not yet covered by a service level agreement.</span></span>

<span data-ttu-id="1a5f2-172">進行異地容錯移轉時，不會變更帳戶的存取方式 (URL 和帳戶金鑰不會變更)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-172">In the event of a geo-failover, there will be no change to how the account is accessed (the URL and account key will not change).</span></span> <span data-ttu-id="1a5f2-173">不過，儲存體帳戶在容錯移轉之後會移至不同區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-173">The storage account will, however, be in a different region after failover.</span></span> <span data-ttu-id="1a5f2-174">這可能會影響儲存體帳戶需要有地緣性的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-174">This could impact applications that require regional affinity with their storage account.</span></span> <span data-ttu-id="1a5f2-175">即使服務和應用程式不要求儲存體帳戶必須在相同資料中心內，由於跨資料中心的延遲和頻寬費用，仍可能不得已必須暫時將流量移至容錯移轉區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-175">Even for services and applications that do not require a storage account in the same datacenter, the cross-datacenter latency and bandwidth charges might be compelling reasons to move traffic to the failover region temporarily.</span></span> <span data-ttu-id="1a5f2-176">這個因素需要納入整體災害復原策略中。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-176">This could factor into an overall disaster recovery strategy.</span></span>

<span data-ttu-id="1a5f2-177">除了 GRS 所提供的自動容錯移轉，Azure 還引進一項服務，可讓您讀取次要儲存體位置中的資料複本。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-177">In addition to automatic failover provided by GRS, Azure has introduced a service that gives you read access to the copy of your data in the secondary storage location.</span></span> <span data-ttu-id="1a5f2-178">這稱為讀取權限異地備援儲存體 (RA-GRS)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-178">This is called Read-Access Geo-Redundant Storage (RA-GRS).</span></span>

<span data-ttu-id="1a5f2-179">如需 GRS 和 RA-GRS 儲存體的詳細資訊，請參閱 [Azure 儲存體複寫](/azure/storage/storage-redundancy/)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-179">For more information about both GRS and RA-GRS storage, see [Azure Storage replication](/azure/storage/storage-redundancy/).</span></span>

### <a name="geo-replication-region-mappings"></a><span data-ttu-id="1a5f2-180">異地複寫區域對應</span><span class="sxs-lookup"><span data-stu-id="1a5f2-180">Geo-Replication region mappings</span></span>

<span data-ttu-id="1a5f2-181">必須知道資料異地複寫到何處，才能知道需要儲存體地緣性的其他資料執行個體要部署到何處。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-181">It is important to know where your data is geo-replicated, in order to know where to deploy the other instances of your data that require regional affinity with your storage.</span></span> <span data-ttu-id="1a5f2-182">如需詳細資訊，請參閱 [Azure 配對的區域](/azure/best-practices-availability-paired-regions)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-182">For more information see [Azure Paired Regions](/azure/best-practices-availability-paired-regions).</span></span>

### <a name="geo-replication-pricing"></a><span data-ttu-id="1a5f2-183">異地複寫價格</span><span class="sxs-lookup"><span data-stu-id="1a5f2-183">Geo-Replication pricing</span></span>

<span data-ttu-id="1a5f2-184">Azure 儲存體的目前價格包含異地複寫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-184">Geo-replication is included in current pricing for Azure Storage.</span></span> <span data-ttu-id="1a5f2-185">這稱為異地備援儲存體 (GRS)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-185">This is called Geo-Redundant Storage (GRS).</span></span> <span data-ttu-id="1a5f2-186">如果您不想異地複寫您的資料，您可以在帳戶中停用異地複寫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-186">If you do not want your data geo-replicated you can disable geo-replication for your account.</span></span> <span data-ttu-id="1a5f2-187">這稱為本地備援儲存體，按照 GRS 的折扣價收費。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-187">This is called Locally Redundant Storage, and it is charged at a discounted price compared to GRS.</span></span>

### <a name="determining-if-a-geo-failover-has-occurred"></a><span data-ttu-id="1a5f2-188">判斷是否發生異地容錯移轉</span><span class="sxs-lookup"><span data-stu-id="1a5f2-188">Determining if a geo-failover has occurred</span></span>

<span data-ttu-id="1a5f2-189">如果發生異地容錯移轉，此消息會張貼到 [Azure 服務健全狀況儀表板](https://azure.microsoft.com/status/)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-189">If a geo-failover occurs, this will be posted to the [Azure Service Health Dashboard](https://azure.microsoft.com/status/).</span></span> <span data-ttu-id="1a5f2-190">不過，應用程式可以實作自動化方法來監視儲存體帳戶的區域，以偵測此狀況。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-190">Applications can implement an automated means of detecting this, however, by monitoring the geo-region for their storage account.</span></span> <span data-ttu-id="1a5f2-191">這可以用來觸發其他復原作業，例如，在儲存體移至的區域啟用計算資源。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-191">This can be used to trigger other recovery operations, such as activation of compute resources in the geo-region where their storage moved to.</span></span> <span data-ttu-id="1a5f2-192">您可以從服務管理 API 透過 [取得儲存體帳戶屬性](https://msdn.microsoft.com/library/ee460802.aspx)來針對此狀況進行查詢。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-192">You can perform a query for this from the service management API, by using [Get Storage Account Properties](https://msdn.microsoft.com/library/ee460802.aspx).</span></span> <span data-ttu-id="1a5f2-193">相關的屬性如下︰</span><span class="sxs-lookup"><span data-stu-id="1a5f2-193">The relevant properties are:</span></span>

    <GeoPrimaryRegion>primary-region</GeoPrimaryRegion>
    <StatusOfPrimary>[Available|Unavailable]</StatusOfPrimary>
    <LastGeoFailoverTime>DateTime</LastGeoFailoverTime>
    <GeoSecondaryRegion>secondary-region</GeoSecondaryRegion>
    <StatusOfSecondary>[Available|Unavailable]</StatusOfSecondary>

### <a name="vm-disks-and-geo-failover"></a><span data-ttu-id="1a5f2-194">VM 磁碟和異地容錯移轉</span><span class="sxs-lookup"><span data-stu-id="1a5f2-194">VM disks and geo-failover</span></span>

<span data-ttu-id="1a5f2-195">如 VM 磁碟一節所述，容錯移轉之後，不保證 VM 磁碟之間的資料一致性。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-195">As discussed in the section on VM disks, there are no guarantees for data consistency across VM disks after a failover.</span></span> <span data-ttu-id="1a5f2-196">為了確保備份的正確性，應該使用備份產品 (例如 Data Protection Manager) 來備份和還原應用程式資料。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-196">To ensure correctness of backups, a backup product such as Data Protection Manager should be used to back up and restore application data.</span></span>

## <a name="database"></a><span data-ttu-id="1a5f2-197">資料庫</span><span class="sxs-lookup"><span data-stu-id="1a5f2-197">Database</span></span>

### <a name="sql-database"></a><span data-ttu-id="1a5f2-198">SQL Database</span><span class="sxs-lookup"><span data-stu-id="1a5f2-198">SQL Database</span></span>

<span data-ttu-id="1a5f2-199">Azure SQL Database 提供兩種復原：異地還原和作用中異地複寫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-199">Azure SQL Database provides two types of recovery: Geo-Restore and Active Geo-Replication.</span></span>

#### <a name="geo-restore"></a><span data-ttu-id="1a5f2-200">異地還原</span><span class="sxs-lookup"><span data-stu-id="1a5f2-200">Geo-Restore</span></span>

<span data-ttu-id="1a5f2-201">[異地還原](/azure/sql-database/sql-database-recovery-using-backups/#geo-restore) 也適用於基本、標準和進階資料庫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-201">[Geo-Restore](/azure/sql-database/sql-database-recovery-using-backups/#geo-restore) is also available with Basic, Standard, and Premium databases.</span></span> <span data-ttu-id="1a5f2-202">它會在資料庫因裝載區域中的事件而無法使用時，提供預設復原選項。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-202">It provides the default recovery option when the database is unavailable because of an incident in the region where your database is hosted.</span></span> <span data-ttu-id="1a5f2-203">異地還原與還原時間點類似，需要使用 Azure 異地備援儲存體中的資料庫備份。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-203">Similar to Point-In-Time Restore, Geo-Restore relies on database backups in geo-redundant Azure storage.</span></span> <span data-ttu-id="1a5f2-204">它會從異地複寫的備份複本還原，因此可彈性地回應主要區域的儲存體中斷情況。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-204">It restores from the geo-replicated backup copy, and therefore is resilient to the storage outages in the primary region.</span></span> <span data-ttu-id="1a5f2-205">詳細資訊請參閱 [還原 Azure SQL Database 或容錯移轉到次要資料庫](/azure/sql-database/sql-database-disaster-recovery/)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-205">For more details, see [Restore an Azure SQL Database or failover to a secondary](/azure/sql-database/sql-database-disaster-recovery/).</span></span>

#### <a name="active-geo-replication"></a><span data-ttu-id="1a5f2-206">主動式異地複寫</span><span class="sxs-lookup"><span data-stu-id="1a5f2-206">Active Geo-Replication</span></span>

<span data-ttu-id="1a5f2-207">[作用中異地複寫](/azure/sql-database/sql-database-geo-replication-overview/) 適用於所有資料庫層。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-207">[Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/) is available for all database tiers.</span></span> <span data-ttu-id="1a5f2-208">其設計是針對比異地還原需要更主動復原的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-208">It’s designed for applications that have more aggressive recovery requirements than Geo-Restore can offer.</span></span> <span data-ttu-id="1a5f2-209">透過主動式異地複寫，您可以在不同區域的伺服器上最多建立四個可讀取的次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-209">Using Active Geo-Replication, you can create up to four readable secondaries on servers in different regions.</span></span> <span data-ttu-id="1a5f2-210">您可以起始容錯移轉至任何次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-210">You can initiate failover to any of the secondaries.</span></span> <span data-ttu-id="1a5f2-211">此外，主動式異地複寫可用來支援應用程式升級或重新配置案例，以及對唯讀工作負載進行負載平衡。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-211">In addition, Active Geo-Replication can be used to support the application upgrade or relocation scenarios, as well as load balancing for read-only workloads.</span></span> <span data-ttu-id="1a5f2-212">如需詳細資訊，請參閱[設定異地複寫](/azure/sql-database/sql-database-geo-replication-portal/)和[容錯移轉至次要資料庫](/azure/sql-database/sql-database-geo-replication-failover-portal/)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-212">For details, see [configure Geo-Replication](/azure/sql-database/sql-database-geo-replication-portal/) and to [fail over to the secondary database](/azure/sql-database/sql-database-geo-replication-failover-portal/).</span></span> <span data-ttu-id="1a5f2-213">請參閱[使用 SQL Database 的主動式異地複寫設計雲端災害復原應用程式](/azure/sql-database/sql-database-designing-cloud-solutions-for-disaster-recovery/)和[使用 SQL Database 主動式異地複寫管理雲端應用程式的輪流升級](/azure/sql-database/sql-database-manage-application-rolling-upgrade/)，以取得如何設計和實作應用程式以及在不停機情況下升級應用程式的詳細說明。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-213">Refer to [Design an application for cloud disaster recovery using Active Geo-Replication in SQL Database](/azure/sql-database/sql-database-designing-cloud-solutions-for-disaster-recovery/) and [Managing rolling upgrades of cloud applications using SQL Database Active Geo-Replication](/azure/sql-database/sql-database-manage-application-rolling-upgrade/) for details on how to design and implement applications and applications upgrade without downtime.</span></span>

### <a name="sql-server-on-virtual-machines"></a><span data-ttu-id="1a5f2-214">虛擬機器上的 SQL Server</span><span class="sxs-lookup"><span data-stu-id="1a5f2-214">SQL Server on Virtual Machines</span></span>

<span data-ttu-id="1a5f2-215">Azure 虛擬機器中執行的 SQL Server 2012 (和更新版本) 有各種選項可進行復原和維持高可用性。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-215">A variety of options are available for recovery and high availability for SQL Server 2012 (and later) running in Azure Virtual Machines.</span></span> <span data-ttu-id="1a5f2-216">如需詳細資訊，請參閱 [Azure 虛擬機器中的 SQL Server 高可用性和災害復原](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-216">For more information, see [High availability and disaster recovery for SQL Server in Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

## <a name="other-azure-platform-services"></a><span data-ttu-id="1a5f2-217">其他 Azure 平台服務</span><span class="sxs-lookup"><span data-stu-id="1a5f2-217">Other Azure platform services</span></span>

<span data-ttu-id="1a5f2-218">嘗試在多個 Azure 區域執行您的雲端服務時，您必須考量每個相依性的含意。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-218">When attempting to run your cloud service in multiple Azure regions, you must consider the implications for each of your dependencies.</span></span> <span data-ttu-id="1a5f2-219">在下列各節中，特定服務的指引假設您必須在替代的 Azure 資料中心內使用相同的 Azure 服務。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-219">In the following sections, the service-specific guidance assumes that you must use the same Azure service in an alternate Azure datacenter.</span></span> <span data-ttu-id="1a5f2-220">這牽涉到組態和資料複寫工作。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-220">This involves both configuration and data-replication tasks.</span></span>

> [!NOTE]
> <span data-ttu-id="1a5f2-221">在某些情況下，這些步驟有助於緩和特定服務中斷運作，而不是資料中心全面性事件。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-221">In some cases, these steps can help to mitigate a service-specific outage rather than an entire datacenter event.</span></span> <span data-ttu-id="1a5f2-222">從應用程式的觀點來看，特定服務中斷運作可能只是功能受限，需要暫時將服務移轉到替代的 Azure 區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-222">From the application perspective, a service-specific outage might be just as limiting and would require temporarily migrating the service to an alternate Azure region.</span></span>

### <a name="service-bus"></a><span data-ttu-id="1a5f2-223">服務匯流排</span><span class="sxs-lookup"><span data-stu-id="1a5f2-223">Service Bus</span></span>

<span data-ttu-id="1a5f2-224">Azure 服務匯流排使用不跨越 Azure 區域的唯一命名空間。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-224">Azure Service Bus uses a unique namespace that does not span Azure regions.</span></span> <span data-ttu-id="1a5f2-225">因此，第一項需求是在替代區域設定必要的服務匯流排命名空間。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-225">So the first requirement is to setup the necessary service bus namespaces in the alternate region.</span></span> <span data-ttu-id="1a5f2-226">不過，還需要考量佇列訊息的持久性。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-226">However, there are also considerations for the durability of the queued messages.</span></span> <span data-ttu-id="1a5f2-227">跨 Azure 區域複寫訊息有幾種策略。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-227">There are several strategies for replicating messages across Azure regions.</span></span> <span data-ttu-id="1a5f2-228">如需這些複寫策略和其他災害復原策略的詳細資訊，請參閱 [將應用程式與服務匯流排中斷和災害隔絕的最佳作法](/azure/service-bus-messaging/service-bus-outages-disasters/)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-228">For the details on these replication strategies and other disaster recovery strategies, see [Best practices for insulating applications against Service Bus outages and disasters](/azure/service-bus-messaging/service-bus-outages-disasters/).</span></span> <span data-ttu-id="1a5f2-229">關於其他可用性考量，請參閱 [服務匯流排 (可用性)](recovery-local-failures.md#other-azure-platform-services)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-229">For other availability considerations, see [Service Bus (Availability)](recovery-local-failures.md#other-azure-platform-services).</span></span>

### <a name="app-service"></a><span data-ttu-id="1a5f2-230">App Service 方案</span><span class="sxs-lookup"><span data-stu-id="1a5f2-230">App Service</span></span>

<span data-ttu-id="1a5f2-231">若要將 Azure App Service 應用程式，例如 Web Apps 或 Mobile Apps 移轉到次要 Azure 區域，您必須有可供發佈的網站備份。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-231">To migrate an Azure App Service application, such as Web Apps or Mobile Apps, to a secondary Azure region, you must have a backup of the website available for publishing.</span></span> <span data-ttu-id="1a5f2-232">如果運作中斷未波及整個 Azure 資料中心，或許可以使用 FTP 下載網站內容的最新備份。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-232">If the outage does not involve the entire Azure datacenter, it might be possible to use FTP to download a recent backup of the site content.</span></span> <span data-ttu-id="1a5f2-233">然後，在替代區域建立新的應用程式，除非您先前為了保留容量而已經這樣做。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-233">Then create a new app in the alternate region, unless you have previously done this to reserve capacity.</span></span> <span data-ttu-id="1a5f2-234">將網站發佈到新的區域，並進行任何必要的組態變更。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-234">Publish the site to the new region, and make any necessary configuration changes.</span></span> <span data-ttu-id="1a5f2-235">這些變更可能包括資料庫連接字串或區域專用的其他設定。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-235">These changes could include database connection strings or other region-specific settings.</span></span> <span data-ttu-id="1a5f2-236">如有需要，新增網站的 SSL 憑證，並變更 DNS CNAME 記錄，使自訂網域名稱指向重新部署的 Azure Web 應用程式 URL。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-236">If necessary, add the site’s SSL certificate and change the DNS CNAME record so that the custom domain name points to the redeployed Azure Web App URL.</span></span>

### <a name="hdinsight"></a><span data-ttu-id="1a5f2-237">HDInsight</span><span class="sxs-lookup"><span data-stu-id="1a5f2-237">HDInsight</span></span>

<span data-ttu-id="1a5f2-238">根據預設，與 HDInsight 相關聯的資料會儲存在 Azure Blob 儲存體中。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-238">The data associated with HDInsight is stored by default in Azure Blob Storage.</span></span> <span data-ttu-id="1a5f2-239">HDInsight 要求 Hadoop 叢集處理 MapReduce 作業，以及包含要分析之資料的儲存體帳戶，必須並存於相同的區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-239">HDInsight requires that a Hadoop cluster processing MapReduce jobs must be co-located in the same region as the storage account that contains the data being analyzed.</span></span> <span data-ttu-id="1a5f2-240">假設您使用 Azure 儲存體可用的異地複寫功能，如果主要區域因為某些原因而無法再使用，您可以在已複寫資料的次要地區存取您的資料。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-240">Provided you use the geo-replication feature available to Azure Storage, you can access your data in the secondary region where the data was replicated if for some reason the primary region is no longer available.</span></span> <span data-ttu-id="1a5f2-241">您可以在已複寫資料的區域建立新的 Hadoop 叢集，然後繼續處理資料。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-241">You can create a new Hadoop cluster in the region where the data has been replicated and continue processing it.</span></span> <span data-ttu-id="1a5f2-242">關於其他可用性考量，請參閱 [HDInsight (可用性)](recovery-local-failures.md#other-azure-platform-services)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-242">For other availability considerations, see [HDInsight (Availability)](recovery-local-failures.md#other-azure-platform-services).</span></span>

### <a name="sql-reporting"></a><span data-ttu-id="1a5f2-243">SQL Reporting</span><span class="sxs-lookup"><span data-stu-id="1a5f2-243">SQL Reporting</span></span>

<span data-ttu-id="1a5f2-244">目前，需要有多個 SQL Reporting 執行個體在不同 Azure 區域中，才能從 Azure 區域遺失中復原。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-244">At this time, recovering from the loss of an Azure region requires multiple SQL Reporting instances in different Azure regions.</span></span> <span data-ttu-id="1a5f2-245">這些 SQL Reporting 執行個體應該存取相同的資料，且該資料必須有自己的復原計畫來因應災害。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-245">These SQL Reporting instances should access the same data, and that data should have its own recovery plan in the event of a disaster.</span></span> <span data-ttu-id="1a5f2-246">您也可以為每份報告維護 RDL 檔案的外部備份複本。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-246">You can also maintain external backup copies of the RDL file for each report.</span></span>

### <a name="media-services"></a><span data-ttu-id="1a5f2-247">媒體服務</span><span class="sxs-lookup"><span data-stu-id="1a5f2-247">Media Services</span></span>

<span data-ttu-id="1a5f2-248">Azure 媒體服務在編碼和串流處理方面有不同的復原方法。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-248">Azure Media Services has a different recovery approach for encoding and streaming.</span></span> <span data-ttu-id="1a5f2-249">一般而言，在區域性中斷運作期間，串流處理較重要。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-249">Typically, streaming is more critical during a regional outage.</span></span> <span data-ttu-id="1a5f2-250">為了對此有所準備，您應該在兩個不同 Azure 區域中都有媒體服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-250">To prepare for this, you should have a Media Services account in two different Azure regions.</span></span> <span data-ttu-id="1a5f2-251">編碼的內容應該放在這兩個區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-251">The encoded content should be located in both regions.</span></span> <span data-ttu-id="1a5f2-252">在失敗期間，您可以將串流流量重新導向替代區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-252">During a failure, you can redirect the streaming traffic to the alternate region.</span></span> <span data-ttu-id="1a5f2-253">任何 Azure 區域中都可以執行編碼。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-253">Encoding can be performed in any Azure region.</span></span> <span data-ttu-id="1a5f2-254">如果編碼時間緊迫，例如，在即時事件處理期間，您必須能夠在失敗期間將作業提交至替代資料中心。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-254">If encoding is time-sensitive, for example during live event processing, you must be prepared to submit jobs to an alternate datacenter during failures.</span></span>

### <a name="virtual-network"></a><span data-ttu-id="1a5f2-255">虛擬網路</span><span class="sxs-lookup"><span data-stu-id="1a5f2-255">Virtual network</span></span>

<span data-ttu-id="1a5f2-256">組態檔提供最快的方式在替代 Azure 區域中設定虛擬網路。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-256">Configuration files provide the quickest way to set up a virtual network in an alternate Azure region.</span></span> <span data-ttu-id="1a5f2-257">在主要 Azure 區域中設定虛擬網路之後，從目前網路 [匯出虛擬網路設定](/azure/virtual-network/virtual-networks-create-vnet-classic-portal/) 到網路組態檔。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-257">After configuring the virtual network in the primary Azure region, [export the virtual network settings](/azure/virtual-network/virtual-networks-create-vnet-classic-portal/) for the current network to a network configuration file.</span></span> <span data-ttu-id="1a5f2-258">萬一主要區域中斷運作，請從儲存的組態檔 [還原虛擬網路](/azure/virtual-network/virtual-networks-create-vnet-classic-portal/) 。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-258">In the event of an outage in the primary region, [restore the virtual network](/azure/virtual-network/virtual-networks-create-vnet-classic-portal/) from the stored configuration file.</span></span> <span data-ttu-id="1a5f2-259">接著，設定其他雲端服務、虛擬機器或跨單位設定來使用新的虛擬網路。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-259">Then configure other cloud services, virtual machines, or cross-premises settings to work with the new virtual network.</span></span>

## <a name="checklists-for-disaster-recovery"></a><span data-ttu-id="1a5f2-260">災害復原檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-260">Checklists for disaster recovery</span></span>

## <a name="cloud-services-checklist"></a><span data-ttu-id="1a5f2-261">雲端服務檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-261">Cloud Services checklist</span></span>

1. <span data-ttu-id="1a5f2-262">檢閱此文件的＜雲端服務＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-262">Review the Cloud Services section of this document.</span></span>
2. <span data-ttu-id="1a5f2-263">建立跨區域災害復原策略。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-263">Create a cross-region disaster recovery strategy.</span></span>
3. <span data-ttu-id="1a5f2-264">了解在替代區域保留容量的利弊取捨。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-264">Understand trade-offs in reserving capacity in alternate regions.</span></span>
4. <span data-ttu-id="1a5f2-265">使用流量路由工具，例如 Azure 流量管理員。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-265">Use traffic routing tools, such as Azure Traffic Manager.</span></span>

## <a name="virtual-machines-checklist"></a><span data-ttu-id="1a5f2-266">虛擬機器檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-266">Virtual Machines checklist</span></span>

1. <span data-ttu-id="1a5f2-267">檢閱此文件的＜虛擬機器＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-267">Review the Virtual Machines section of this document.</span></span>
2. <span data-ttu-id="1a5f2-268">使用 [Azure 備份](https://azure.microsoft.com/services/backup/) 建立跨區域的應用程式一致備份。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-268">Use [Azure Backup](https://azure.microsoft.com/services/backup/) to create application consistent backups across regions.</span></span>

## <a name="storage-checklist"></a><span data-ttu-id="1a5f2-269">儲存體檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-269">Storage checklist</span></span>

1. <span data-ttu-id="1a5f2-270">檢閱此文件的＜儲存體＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-270">Review the Storage section of this document.</span></span>
2. <span data-ttu-id="1a5f2-271">請勿停用儲存體資源的異地複寫。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-271">Do not disable geo-replication of storage resources.</span></span>
3. <span data-ttu-id="1a5f2-272">了解容錯移轉時異地複寫的替代區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-272">Understand alternate region for geo-replication in the event of failover.</span></span>
4. <span data-ttu-id="1a5f2-273">針對使用者控制的容錯移轉策略建立自訂的備份策略。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-273">Create custom backup strategies for user-controlled failover strategies.</span></span>

## <a name="sql-database-checklist"></a><span data-ttu-id="1a5f2-274">SQL Database 檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-274">SQL Database checklist</span></span>

1. <span data-ttu-id="1a5f2-275">檢閱此文件的＜SQL Database＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-275">Review the SQL Database section of this document.</span></span>
2. <span data-ttu-id="1a5f2-276">視需要使用[異地還原](/azure/sql-database/sql-database-recovery-using-backups/#geo-restore)或[異地複寫](/azure/sql-database/sql-database-geo-replication-overview/)。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-276">Use [Geo-Restore](/azure/sql-database/sql-database-recovery-using-backups/#geo-restore) or [Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/) as appropriate.</span></span>

## <a name="sql-server-on-virtual-machines-checklist"></a><span data-ttu-id="1a5f2-277">虛擬機器上的 SQL Server 檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-277">SQL Server on Virtual Machines checklist</span></span>

1. <span data-ttu-id="1a5f2-278">檢閱此文件的＜虛擬機器上的 SQL Server＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-278">Review the SQL Server on Virtual Machines section of this document.</span></span>
2. <span data-ttu-id="1a5f2-279">使用跨區域 AlwaysOn 可用性群組或資料庫鏡像。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-279">Use cross-region AlwaysOn Availability Groups or database mirroring.</span></span>
3. <span data-ttu-id="1a5f2-280">或者使用備份及還原到 Blob 儲存體。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-280">Alternately use backup and restore to blob storage.</span></span>

## <a name="service-bus-checklist"></a><span data-ttu-id="1a5f2-281">服務匯流排檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-281">Service Bus checklist</span></span>

1. <span data-ttu-id="1a5f2-282">檢閱此文件的＜服務匯流排＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-282">Review the Service Bus section of this document.</span></span>
2. <span data-ttu-id="1a5f2-283">在替代區域中設定服務匯流排命名空間。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-283">Configure a Service Bus namespace in an alternate region.</span></span>
3. <span data-ttu-id="1a5f2-284">針對跨區域訊息考慮採用自訂的複寫策略。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-284">Consider custom replication strategies for messages across regions.</span></span>

## <a name="app-service-checklist"></a><span data-ttu-id="1a5f2-285">App Service 檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-285">App Service checklist</span></span>

1. <span data-ttu-id="1a5f2-286">檢閱此文件的＜App Service＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-286">Review the App Service section of this document.</span></span>
2. <span data-ttu-id="1a5f2-287">在主要區域外部維護網站備份。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-287">Maintain site backups outside of the primary region.</span></span>
3. <span data-ttu-id="1a5f2-288">如果是局部性中斷運作，嘗試使用 FTP 擷取目前站台。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-288">If outage is partial, attempt to retrieve current site with FTP.</span></span>
4. <span data-ttu-id="1a5f2-289">規劃將網站部署到替代區域中的新網站或現有網站。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-289">Plan to deploy the site to new or existing site in an alternate region.</span></span>
5. <span data-ttu-id="1a5f2-290">規劃應用程式與 DNS CNAME 記錄的設定變更。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-290">Plan configuration changes for both application and DNS CNAME records.</span></span>

## <a name="hdinsight-checklist"></a><span data-ttu-id="1a5f2-291">HDInsight 檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-291">HDInsight checklist</span></span>

1. <span data-ttu-id="1a5f2-292">檢閱此文件的＜HDInsight＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-292">Review the HDInsight section of this document.</span></span>
2. <span data-ttu-id="1a5f2-293">使用複寫的資料在區域建立新的 Hadoop 叢集。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-293">Create a new Hadoop cluster in the region with replicated data.</span></span>

## <a name="sql-reporting-checklist"></a><span data-ttu-id="1a5f2-294">SQL Reporting 檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-294">SQL Reporting checklist</span></span>

1. <span data-ttu-id="1a5f2-295">檢閱此文件的＜SQL Reporting＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-295">Review the SQL Reporting section of this document.</span></span>
2. <span data-ttu-id="1a5f2-296">在不同區域維護替代 SQL Reporting 執行個體。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-296">Maintain an alternate SQL Reporting instance in a different region.</span></span>
3. <span data-ttu-id="1a5f2-297">維護個別計畫將目標複寫到該區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-297">Maintain a separate plan to replicate the target to that region.</span></span>

## <a name="media-services-checklist"></a><span data-ttu-id="1a5f2-298">媒體服務檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-298">Media Services checklist</span></span>

1. <span data-ttu-id="1a5f2-299">檢閱此文件的＜媒體服務＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-299">Review the Media Services section of this document.</span></span>
2. <span data-ttu-id="1a5f2-300">在替代區域建立媒體服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-300">Create a Media Services account in an alternate region.</span></span>
3. <span data-ttu-id="1a5f2-301">編碼兩個區域中相同的內容以支援串流容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-301">Encode the same content in both regions to support streaming failover.</span></span>
4. <span data-ttu-id="1a5f2-302">於服務中斷時將編碼作業提交至替代區域。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-302">Submit encoding jobs to an alternate region in the event of a service disruption.</span></span>

## <a name="virtual-network-checklist"></a><span data-ttu-id="1a5f2-303">虛擬網路檢查清單</span><span class="sxs-lookup"><span data-stu-id="1a5f2-303">Virtual Network checklist</span></span>

1. <span data-ttu-id="1a5f2-304">檢閱此文件的＜虛擬網路＞一節。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-304">Review the Virtual Network section of this document.</span></span>
2. <span data-ttu-id="1a5f2-305">使用匯出的虛擬網路設定在其他區域重新建立它。</span><span class="sxs-lookup"><span data-stu-id="1a5f2-305">Use exported virtual network settings to re-create it in another region.</span></span>
