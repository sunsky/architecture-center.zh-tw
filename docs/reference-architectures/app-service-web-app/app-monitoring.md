---
title: Azure 上的 Web 應用程式監視
description: 監視 Azure App Service 中裝載的 Web 應用程式。
author: adamboeglin
ms.date: 12/12/2018
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: azcat
ms.openlocfilehash: 5219d08fce5cf09b075b6d7adfb73970e007ded4
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/20/2019
ms.locfileid: "58248673"
---
# <a name="web-application-monitoring-on-azure"></a><span data-ttu-id="ff148-103">Azure 上的 Web 應用程式監視</span><span class="sxs-lookup"><span data-stu-id="ff148-103">Web application monitoring on Azure</span></span>

<span data-ttu-id="ff148-104">Azure 平台即服務 (PaaS) 供應項目可為您管理計算資源，並且改變您監視部署的方式。</span><span class="sxs-lookup"><span data-stu-id="ff148-104">Azure platform as a service (PaaS) offerings manage compute resources for you and affect how you monitor deployments.</span></span> <span data-ttu-id="ff148-105">Azure 包含多項監視服務，各自會執行特定的角色。</span><span class="sxs-lookup"><span data-stu-id="ff148-105">Azure includes multiple monitoring services, each of which performs a specific role.</span></span> <span data-ttu-id="ff148-106">這些服務可共同提供一套全面性解決方案，以便收集、分析來自您的應用程式和所用 Azure 資源的遙測，並採取行動。</span><span class="sxs-lookup"><span data-stu-id="ff148-106">Together, these services deliver a comprehensive solution for collecting, analyzing, and acting on telemetry from your applications and the Azure resources they consume.</span></span>

<span data-ttu-id="ff148-107">此案例說明您可以使用的監視服務，以及描述可搭配多個資料來源使用的資料流程模型。</span><span class="sxs-lookup"><span data-stu-id="ff148-107">This scenario addresses the monitoring services you can use and describes a dataflow model for use with multiple data sources.</span></span> <span data-ttu-id="ff148-108">說到監視，許多工具和服務都會使用 Azure 部署。</span><span class="sxs-lookup"><span data-stu-id="ff148-108">When it comes to monitoring, many tools and services work with Azure deployments.</span></span> <span data-ttu-id="ff148-109">在此案例中，我們明確地選擇立即可用的服務，因為這些服務取用方便。</span><span class="sxs-lookup"><span data-stu-id="ff148-109">In this scenario, we choose readily available services precisely because they are easy to consume.</span></span> <span data-ttu-id="ff148-110">本文稍後會討論其他監視選項。</span><span class="sxs-lookup"><span data-stu-id="ff148-110">Other monitoring options are discussed later in this article.</span></span>

## <a name="relevant-use-cases"></a><span data-ttu-id="ff148-111">相關使用案例</span><span class="sxs-lookup"><span data-stu-id="ff148-111">Relevant use cases</span></span>

<span data-ttu-id="ff148-112">其他相關的使用案例包括：</span><span class="sxs-lookup"><span data-stu-id="ff148-112">Other relevant use cases include:</span></span>

- <span data-ttu-id="ff148-113">檢測用於監視遙測的 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="ff148-113">Instrumenting a web application for monitoring telemetry.</span></span>
- <span data-ttu-id="ff148-114">針對 Azure 上部署的應用程式收集前端和後端遙測。</span><span class="sxs-lookup"><span data-stu-id="ff148-114">Collecting front-end and back-end telemetry for an application deployed on Azure.</span></span>
- <span data-ttu-id="ff148-115">監視與 Azure 上的服務相關聯的計量和配額。</span><span class="sxs-lookup"><span data-stu-id="ff148-115">Monitoring metrics and quotas associated with services on Azure.</span></span>

## <a name="architecture"></a><span data-ttu-id="ff148-116">架構</span><span class="sxs-lookup"><span data-stu-id="ff148-116">Architecture</span></span>

![「架構圖」](./images/architecture-diagram-app-monitoring.svg)

<span data-ttu-id="ff148-118">此案例會使用受控 Azure 環境來裝載應用程式和資料層。</span><span class="sxs-lookup"><span data-stu-id="ff148-118">This scenario uses a managed Azure environment to host an application and data tier.</span></span> <span data-ttu-id="ff148-119">整個案例的資料流程如下所示：</span><span class="sxs-lookup"><span data-stu-id="ff148-119">The data flows through the scenario as follows:</span></span>

1. <span data-ttu-id="ff148-120">使用者會與應用程式互動。</span><span class="sxs-lookup"><span data-stu-id="ff148-120">A user interacts with the application.</span></span>
2. <span data-ttu-id="ff148-121">瀏覽器和應用程式服務會發出遙測。</span><span class="sxs-lookup"><span data-stu-id="ff148-121">The browser and app service emit telemetry.</span></span>
3. <span data-ttu-id="ff148-122">Application Insights 會收集及分析應用程式健康情況、效能和使用量資料。</span><span class="sxs-lookup"><span data-stu-id="ff148-122">Application Insights collects and analyzes application health, performance, and usage data.</span></span>
4. <span data-ttu-id="ff148-123">開發人員與系統管理員可以檢閱健康情況、效能及使用量資訊。</span><span class="sxs-lookup"><span data-stu-id="ff148-123">Developers and administrators can review health, performance, and usage information.</span></span>
5. <span data-ttu-id="ff148-124">Azure SQL Database 會發出遙測。</span><span class="sxs-lookup"><span data-stu-id="ff148-124">Azure SQL Database emits telemetry.</span></span>
6. <span data-ttu-id="ff148-125">Azure 監視器會收集並分析基礎結構計量與配額。</span><span class="sxs-lookup"><span data-stu-id="ff148-125">Azure Monitor collects and analyzes infrastructure metrics and quotas.</span></span>
7. <span data-ttu-id="ff148-126">Log Analytics 會收集及分析記錄與計量。</span><span class="sxs-lookup"><span data-stu-id="ff148-126">Log Analytics collects and analyzes logs and metrics.</span></span>
8. <span data-ttu-id="ff148-127">開發人員與系統管理員可以檢閱健康情況、效能及使用量資訊。</span><span class="sxs-lookup"><span data-stu-id="ff148-127">Developers and administrators can review health, performance, and usage information.</span></span>

### <a name="components"></a><span data-ttu-id="ff148-128">元件</span><span class="sxs-lookup"><span data-stu-id="ff148-128">Components</span></span>

- <span data-ttu-id="ff148-129">[Azure App Service](/azure/app-service/) 是一項 PaaS 服務，可在受控虛擬機器中建置及裝載應用程式。</span><span class="sxs-lookup"><span data-stu-id="ff148-129">[Azure App Service](/azure/app-service/) is a PaaS service for building and hosting apps in managed virtual machines.</span></span> <span data-ttu-id="ff148-130">系統會為您管理應用程式執行所在的基礎計算基礎結構。</span><span class="sxs-lookup"><span data-stu-id="ff148-130">The underlying compute infrastructures on which your apps run is managed for you.</span></span> <span data-ttu-id="ff148-131">App Service 可供監視資源使用量配額和應用程式計量、記錄診斷資訊，以及根據計量發出警示。</span><span class="sxs-lookup"><span data-stu-id="ff148-131">App Service provides monitoring of resource usage quotas and app metrics, logging of diagnostic information, and alerts based on metrics.</span></span> <span data-ttu-id="ff148-132">更棒的是，您可以使用 Application Insights 來建立[可用性測試][availability-tests]，以從不同的區域測試您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ff148-132">Even better, you can use Application Insights to create [availability tests][availability-tests] for testing your application from different regions.</span></span>
- <span data-ttu-id="ff148-133">[Application Insights][application-insights] 是開發人員所適用的可延伸「應用程式效能管理」(APM) 服務，可支援多個平台。</span><span class="sxs-lookup"><span data-stu-id="ff148-133">[Application Insights][application-insights] is an extensible Application Performance Management (APM) service for developers and supports multiple platforms.</span></span> <span data-ttu-id="ff148-134">它可監視應用程式、偵測應用程式異常行為 (例如效能不佳與失敗)，以及將遙測傳送至 Azure 入口網站。</span><span class="sxs-lookup"><span data-stu-id="ff148-134">It monitors the application, detects application anomalies such as poor performance and failures, and sends telemetry to the Azure portal.</span></span> <span data-ttu-id="ff148-135">Application Insights 也可用於記錄、分散式追蹤和自訂應用程式計量。</span><span class="sxs-lookup"><span data-stu-id="ff148-135">Application Insights can also be used for logging, distributed tracing, and custom application metrics.</span></span>
- <span data-ttu-id="ff148-136">[Azure 監視器][azure-monitor]可針對 Azure 中的大多數服務提供基本等級的基礎結構[計量與記錄][metrics]。</span><span class="sxs-lookup"><span data-stu-id="ff148-136">[Azure Monitor][azure-monitor] provides base-level infrastructure [metrics and logs][metrics] for most services in Azure.</span></span> <span data-ttu-id="ff148-137">您有數種方式可與計量互動，包括在 Azure 入口網站中製作計量圖表、透過 REST API 存取計量，或使用 PowerShell 或 CLI 查詢計量。</span><span class="sxs-lookup"><span data-stu-id="ff148-137">You can interact with the metrics in several ways, including charting them in Azure portal, accessing them through the REST API, or querying them using PowerShell or CLI.</span></span> <span data-ttu-id="ff148-138">Azure 監視器也會將其資料直接提供給 [Log Analytics 和其他服務]，您可在其中查詢資料並將它與內部部署環境或雲端中其他來源的資料結合。</span><span class="sxs-lookup"><span data-stu-id="ff148-138">Azure Monitor also offers its data directly into [Log Analytics and other services], where you can query and combine it with data from other sources on premises or in the cloud.</span></span>
- <span data-ttu-id="ff148-139">[Log Analytics][log-analytics] 可協助將 Application Insights 所收集的使用量和效能資料與支援應用程式之所有 Azure 資源的組態和效能資料相互關聯。</span><span class="sxs-lookup"><span data-stu-id="ff148-139">[Log Analytics][log-analytics] helps correlate the usage and performance data collected by Application Insights with configuration and performance data across the Azure resources that support the app.</span></span> <span data-ttu-id="ff148-140">此案例會使用 [Azure Log Analytics 代理程式][Azure Log Analytics agent]將 SQL Server 稽核記錄推送到 Log Analytics。</span><span class="sxs-lookup"><span data-stu-id="ff148-140">This scenario uses the [Azure Log Analytics agent][Azure Log Analytics agent] to push SQL Server audit logs into Log Analytics.</span></span> <span data-ttu-id="ff148-141">您可以在 Azure 入口網站的 Log Analytics 刀鋒視窗中撰寫查詢及檢視資料。</span><span class="sxs-lookup"><span data-stu-id="ff148-141">You can write queries and view data in the Log Analytics blade of the Azure portal.</span></span>

## <a name="considerations"></a><span data-ttu-id="ff148-142">考量</span><span class="sxs-lookup"><span data-stu-id="ff148-142">Considerations</span></span>

<span data-ttu-id="ff148-143">建議做法是在開發期間使用 [Application Insights SDK][Application Insights SDKs] 將 Application Insights 新增至您的程式碼，以及針對每個應用程式加以自訂。</span><span class="sxs-lookup"><span data-stu-id="ff148-143">A recommended practice is adding Application Insights to your code during development using the [Application Insights SDKs][Application Insights SDKs], and customizing per application.</span></span> <span data-ttu-id="ff148-144">這些開放原始碼 SDK 可供大部分的應用程式架構使用。</span><span class="sxs-lookup"><span data-stu-id="ff148-144">These open-source SDKs are available for most application frameworks.</span></span> <span data-ttu-id="ff148-145">若要擴充及控制您所收集的資料，請將用於測試和生產部署的兩個 SDK 併入您的開發程序中。</span><span class="sxs-lookup"><span data-stu-id="ff148-145">To enrich and control the data you collect, incorporate the use of the SDKs both for testing and production deployments into your development process.</span></span> <span data-ttu-id="ff148-146">主要需求是讓應用程式能夠直接或間接檢視使用網際網路對應位址裝載的 Application Insights 擷取端點。</span><span class="sxs-lookup"><span data-stu-id="ff148-146">The main requirement is for the app to have a direct or indirect line of sight to the Applications Insights ingestion endpoint hosted with an Internet-facing address.</span></span> <span data-ttu-id="ff148-147">然後，您可以新增遙測，或擴充現有的遙測集合。</span><span class="sxs-lookup"><span data-stu-id="ff148-147">You can then add telemetry or enrich an existing telemetry collection.</span></span>

<span data-ttu-id="ff148-148">執行階段監視是另一個簡單的開始使用方法。</span><span class="sxs-lookup"><span data-stu-id="ff148-148">Runtime monitoring is another easy way to get started.</span></span> <span data-ttu-id="ff148-149">所收集的遙測必須透過組態檔控制。</span><span class="sxs-lookup"><span data-stu-id="ff148-149">The telemetry that is collected must be controlled through configuration files.</span></span> <span data-ttu-id="ff148-150">例如，您可以包含可啟用 [Application Insights 狀態監視器][Application Insights Status Monitor] 等工具的執行階段方法，以將 SDK 部署到正確的資料夾，並新增正確的組態以開始監視。</span><span class="sxs-lookup"><span data-stu-id="ff148-150">For example, you can include runtime methods that enable tools such as [Application Insights Status Monitor][Application Insights Status Monitor] to deploy the SDKs into the correct folder and add the right configurations to begin monitoring.</span></span>

<span data-ttu-id="ff148-151">如同 Application Insights，Log Analytics 會提供一些工具，以便[分析不同來源的資料][analyzing data across sources]建立複雜的查詢，以及在指定的情況中[傳送主動式警示][sending proactive alerts]。</span><span class="sxs-lookup"><span data-stu-id="ff148-151">Like Application Insights, Log Analytics provides tools for [analyzing data across sources][analyzing data across sources], creating complex queries, and [sending proactive alerts][sending proactive alerts] on specified conditions.</span></span> <span data-ttu-id="ff148-152">您也可以在 [Azure 入口網站][the Azure portal]中檢視遙測。</span><span class="sxs-lookup"><span data-stu-id="ff148-152">You can also view telemetry in [the Azure portal][the Azure portal].</span></span> <span data-ttu-id="ff148-153">Log Analytics 不僅可增加現有監視服務 (例如 [Azure 監視器][azure-monitor]) 的價值，還可監視內部部署環境。</span><span class="sxs-lookup"><span data-stu-id="ff148-153">Log Analytics adds value to existing monitoring services such as [Azure Monitor][azure-monitor] and can also monitor on-premises environments.</span></span>

<span data-ttu-id="ff148-154">Application Insights 和 Log Analytics 均使用 [Azure Log Analytics 查詢語言][Azure Log Analytics Query Language]。</span><span class="sxs-lookup"><span data-stu-id="ff148-154">Both Application Insights and Log Analytics use [Azure Log Analytics Query Language][Azure Log Analytics Query Language].</span></span> <span data-ttu-id="ff148-155">您也可以使用[跨資源查詢](https://azure.microsoft.com/blog/query-across-resources)，在單一查詢中分析 Application Insights 和 Log Analytics 收集的遙測。</span><span class="sxs-lookup"><span data-stu-id="ff148-155">You can also use [cross-resource queries](https://azure.microsoft.com/blog/query-across-resources) to analyze the telemetry gathered by Application Insights and Log Analytics in a single query.</span></span>

<span data-ttu-id="ff148-156">Azure 監視器、Application Insights 及 Log Analytics 全都會傳送[警示](/azure/monitoring-and-diagnostics/monitoring-overview-alerts)。</span><span class="sxs-lookup"><span data-stu-id="ff148-156">Azure Monitor, Application Insights, and Log Analytics all send [alerts](/azure/monitoring-and-diagnostics/monitoring-overview-alerts).</span></span> <span data-ttu-id="ff148-157">例如，Azure 監視器會對平台層級計量 (例如 CPU 使用率) 發出警示，而 Application Insights 會對應用程式層級計量 (例如伺服器回應時間) 發出警示。</span><span class="sxs-lookup"><span data-stu-id="ff148-157">For example, Azure Monitor alerts on platform-level metrics such as CPU utilization, while Application Insights alerts on application-level metrics such as server response time.</span></span> <span data-ttu-id="ff148-158">Azure 監視器會對 Azure 活動記錄中的新事件發出警示，而 Log Analytics 可針對設定要使用它的服務，發出有關計量或事件資料的警示。</span><span class="sxs-lookup"><span data-stu-id="ff148-158">Azure Monitor alerts on new events in the Azure Activity Log, while Log Analytics can issue alerts about metrics or event data for the services configured to use it.</span></span> <span data-ttu-id="ff148-159">[Azure 監視器中的整合警示](/azure/monitoring-and-diagnostics/monitoring-overview-unified-alerts)是 Azure 中一項新的統一警示體驗，其使用不同的分類法。</span><span class="sxs-lookup"><span data-stu-id="ff148-159">[Unified alerts in Azure Monitor](/azure/monitoring-and-diagnostics/monitoring-overview-unified-alerts) is a new, unified alerting experience in Azure that uses a different taxonomy.</span></span>

### <a name="alternatives"></a><span data-ttu-id="ff148-160">替代項目</span><span class="sxs-lookup"><span data-stu-id="ff148-160">Alternatives</span></span>

<span data-ttu-id="ff148-161">本文說明具有熱門功能且方便使用的監視選項，但您有許多選擇，包括用來建立自己的記錄機制的選項。</span><span class="sxs-lookup"><span data-stu-id="ff148-161">This article describes conveniently available monitoring options with popular features, but you have many choices, including the option to create your own logging mechanisms.</span></span> <span data-ttu-id="ff148-162">建議做法是當您在解決方案中建置階層時，新增監視服務。</span><span class="sxs-lookup"><span data-stu-id="ff148-162">A recommended practice is to add monitoring services as you build out tiers in a solution.</span></span> <span data-ttu-id="ff148-163">以下是一些可能的擴充功能和替代項目：</span><span class="sxs-lookup"><span data-stu-id="ff148-163">Here are some possible extensions and alternatives:</span></span>

- <span data-ttu-id="ff148-164">使用[適用於 Grafana 的 Azure 監視器資料來源][Azure Monitor Data Source For Grafana]，在 Grafana 中合併 Azure 監視器和 Application Insights 計量。</span><span class="sxs-lookup"><span data-stu-id="ff148-164">Consolidate Azure Monitor and Application Insights metrics in Grafana using the [Azure Monitor Data Source For Grafana][Azure Monitor Data Source For Grafana].</span></span>
- <span data-ttu-id="ff148-165">[Data Dog][data-dog] 可當作 Azure 監視器的連接器</span><span class="sxs-lookup"><span data-stu-id="ff148-165">[Data Dog][data-dog] features a connector for Azure Monitor</span></span>
- <span data-ttu-id="ff148-166">使用 [Azure 自動化][Azure Automation]自動執行監視功能。</span><span class="sxs-lookup"><span data-stu-id="ff148-166">Automate monitoring functions using [Azure Automation][Azure Automation].</span></span>
- <span data-ttu-id="ff148-167">新增與 [ITSM 解決方案][ITSM solutions]的通訊。</span><span class="sxs-lookup"><span data-stu-id="ff148-167">Add communication with [ITSM solutions][ITSM solutions].</span></span>
- <span data-ttu-id="ff148-168">使用[管理解決方案][management solution]擴充 Log Analytics。</span><span class="sxs-lookup"><span data-stu-id="ff148-168">Extend Log Analytics with a [management solution][management solution].</span></span>

### <a name="scalability-and-availability"></a><span data-ttu-id="ff148-169">延展性和可用性</span><span class="sxs-lookup"><span data-stu-id="ff148-169">Scalability and availability</span></span>

<span data-ttu-id="ff148-170">此案例大部分著重於用來監視的 PaaS 解決方案，因為它們方便為您處理可用性和延展性，而且受服務等級協定 (SLA) 支援。</span><span class="sxs-lookup"><span data-stu-id="ff148-170">This scenario focuses on PaaS solutions for monitoring in large part because they conveniently handle availability and scalability for you and are backed by service-level agreements (SLAs).</span></span> <span data-ttu-id="ff148-171">例如，App Services 會針對其可用性提供保證的 [SLA][SLA]。</span><span class="sxs-lookup"><span data-stu-id="ff148-171">For example, App Services provides a guaranteed [SLA][SLA] for its availability.</span></span>

<span data-ttu-id="ff148-172">Application Insights 會[限制][app-insights-limits]每秒可處理的要求數目。</span><span class="sxs-lookup"><span data-stu-id="ff148-172">Application Insights has [limits][app-insights-limits] on how many requests can be processed per second.</span></span> <span data-ttu-id="ff148-173">如果您超過要求限制，則可能遇到訊息節流。</span><span class="sxs-lookup"><span data-stu-id="ff148-173">If you exceed the request limit, you may experience message throttling.</span></span> <span data-ttu-id="ff148-174">若要避免節流，請實作[篩選][message-filtering]或[取樣][message-sampling]，以降低資料速率</span><span class="sxs-lookup"><span data-stu-id="ff148-174">To prevent throttling, implement [filtering][message-filtering] or [sampling][message-sampling] to reduce the data rate</span></span>

<span data-ttu-id="ff148-175">不過，您所執行的應用程式的高可用性考量是開發人員的責任。</span><span class="sxs-lookup"><span data-stu-id="ff148-175">High availability considerations for the app you run, however, are the developer's responsibility.</span></span> <span data-ttu-id="ff148-176">比方說，如需縮放的相關資訊，請參閱基本 Web 應用程式參考架構中的[延展性考量](#scalability-considerations)一節。</span><span class="sxs-lookup"><span data-stu-id="ff148-176">For information about scale, for example, see the [Scalability considerations](#scalability-considerations) section in the basic web application reference architecture.</span></span> <span data-ttu-id="ff148-177">部署應用程式之後，您可以使用 Application Insights 設定測試來[監視其可用性][monitor its availability]。</span><span class="sxs-lookup"><span data-stu-id="ff148-177">After an app is deployed, you can set up tests to [monitor its availability][monitor its availability] using Application Insights.</span></span>

### <a name="security"></a><span data-ttu-id="ff148-178">安全性</span><span class="sxs-lookup"><span data-stu-id="ff148-178">Security</span></span>

<span data-ttu-id="ff148-179">敏感性資訊與合規性需求會影響資料的收集、保留和儲存。</span><span class="sxs-lookup"><span data-stu-id="ff148-179">Sensitive information and compliance requirements affect data collection, retention, and storage.</span></span> <span data-ttu-id="ff148-180">深入了解 [Application Insights][application-insights] 和 [Log Analytics][log-analytics] 處理遙測的方式。</span><span class="sxs-lookup"><span data-stu-id="ff148-180">Learn more about how [Application Insights][application-insights] and [Log Analytics][log-analytics] handle telemetry.</span></span>

<span data-ttu-id="ff148-181">下列安全性考量可能也適用：</span><span class="sxs-lookup"><span data-stu-id="ff148-181">The following security considerations may also apply:</span></span>

- <span data-ttu-id="ff148-182">如果開發人員能夠收集自己的資料或擴充現有的遙測，請開發一個方案來處理個人資訊。</span><span class="sxs-lookup"><span data-stu-id="ff148-182">Develop a plan to handle personal information if developers are allowed to collect their own data or enrich existing telemetry.</span></span>
- <span data-ttu-id="ff148-183">請考慮資料保留期。</span><span class="sxs-lookup"><span data-stu-id="ff148-183">Consider data retention.</span></span> <span data-ttu-id="ff148-184">例如 Application Insights 可保留遙測資料 90 天。</span><span class="sxs-lookup"><span data-stu-id="ff148-184">For example, Application Insights retains telemetry data for 90 days.</span></span> <span data-ttu-id="ff148-185">使用 Microsoft Power BI、連續匯出或 REST API，封存您想要長時間存取的資料。</span><span class="sxs-lookup"><span data-stu-id="ff148-185">Archive data you want access to for longer periods using Microsoft Power BI, Continuous Export, or the REST API.</span></span> <span data-ttu-id="ff148-186">適用儲存體費率。</span><span class="sxs-lookup"><span data-stu-id="ff148-186">Storage rates apply.</span></span>
- <span data-ttu-id="ff148-187">限制 Azure 資源的存取，以控制資料的存取，以及誰可以檢視來自特定應用程式的遙測。</span><span class="sxs-lookup"><span data-stu-id="ff148-187">Limit access to Azure resources to control access to data and who can view telemetry from a specific application.</span></span> <span data-ttu-id="ff148-188">若要協助鎖定監視遙測的存取，請參閱 [Application Insights 中的資源、角色及存取控制][Resources, roles, and access control in Application Insights]。</span><span class="sxs-lookup"><span data-stu-id="ff148-188">To help lock down access to monitoring telemetry, see [Resources, roles, and access control in Application Insights][Resources, roles, and access control in Application Insights].</span></span>
- <span data-ttu-id="ff148-189">請考慮是否在應用程式程式碼中控制讀取/寫入存取，以防止使用者新增版本或標籤標記來限制從應用程式擷取資料。</span><span class="sxs-lookup"><span data-stu-id="ff148-189">Consider whether to control read/write access in application code to prevent users from adding version or tag markers that limit data ingestion from the application.</span></span> <span data-ttu-id="ff148-190">使用 Application Insights，無法控制已傳送到資源的個別資料項目，因此如果使用者有任何資料的存取權，他們就可以存取個別資源中的所有資料。</span><span class="sxs-lookup"><span data-stu-id="ff148-190">With Application Insights, there is no control over individual data items once they are sent to a resource, so if a user has access to any data, they have access to all data in an individual resource.</span></span>
- <span data-ttu-id="ff148-191">新增[治理](/azure/security/governance-in-azure)機制，視需要對 Azure 資源強制執行原則或成本控制。</span><span class="sxs-lookup"><span data-stu-id="ff148-191">Add [governance](/azure/security/governance-in-azure) mechanisms to enforce policy or cost controls over Azure resources if needed.</span></span> <span data-ttu-id="ff148-192">例如，使用 Log Analytics 進行安全性相關監視 (例如原則和角色型存取控制)，或使用 [Azure 原則](/azure/azure-policy/azure-policy-introduction)來建立、指派及管理原則定義。</span><span class="sxs-lookup"><span data-stu-id="ff148-192">For example, use Log Analytics for security-related monitoring such as policies and role-based access control, or use [Azure Policy](/azure/azure-policy/azure-policy-introduction) to create, assign and, manage policy definitions.</span></span>
- <span data-ttu-id="ff148-193">若要監視潛在的安全性問題，並集中檢視 Azure 資源的安全性狀態，請考慮使用 [Azure 資訊安全中心](/azure/security-center/security-center-intro)。</span><span class="sxs-lookup"><span data-stu-id="ff148-193">To monitor potential security issues and get a central view of the security state of your Azure resources, consider using [Azure Security Center](/azure/security-center/security-center-intro).</span></span>

## <a name="pricing"></a><span data-ttu-id="ff148-194">價格</span><span class="sxs-lookup"><span data-stu-id="ff148-194">Pricing</span></span>

<span data-ttu-id="ff148-195">監視費用可能會快速增加，因此請考慮提前付款定價、了解您所監視的項目，以及檢查與每項服務相關聯的費用。</span><span class="sxs-lookup"><span data-stu-id="ff148-195">Monitoring charges can add up quickly, so consider pricing up front, understand what you are monitoring, and check the associated fees for each service.</span></span> <span data-ttu-id="ff148-196">Azure 監視器會免費提供[基本計量][ basic metrics]，然而 [Application Insights][application-insights-pricing] 和 [Log Analytics][log-analytics] 的監視成本是以擷取的資料量和您所執行的測試數目為基礎。</span><span class="sxs-lookup"><span data-stu-id="ff148-196">Azure Monitor provides [basic metrics][basic metrics] at no cost, while monitoring costs for [Application Insights][application-insights-pricing] and [Log Analytics][log-analytics] are based on the amount of data ingested and the number of tests you run.</span></span>

<span data-ttu-id="ff148-197">若要協助您開始使用，請使用[定價計算機][ pricing]來估計成本。</span><span class="sxs-lookup"><span data-stu-id="ff148-197">To help you get started, use the [pricing calculator][pricing] to estimate costs.</span></span> <span data-ttu-id="ff148-198">若要查看定價如何針對特定使用案例而變更，請變更各種選項，以符合您預期的部署。</span><span class="sxs-lookup"><span data-stu-id="ff148-198">To see how the pricing would change for your particular use case, change the various options to match your expected deployment.</span></span>

<span data-ttu-id="ff148-199">在偵測期間以及在您發佈應用程式之後，來自 Application Insights 的遙測會傳送至 Azure 入口網站。</span><span class="sxs-lookup"><span data-stu-id="ff148-199">Telemetry from Application Insights is sent to the Azure portal during debugging and after you have published your app.</span></span> <span data-ttu-id="ff148-200">基於測試目的，以及為了避免產生費用，檢測的遙測資料數量有限。</span><span class="sxs-lookup"><span data-stu-id="ff148-200">For testing purposes and to avoid charges, a limited volume of telemetry is instrumented.</span></span> <span data-ttu-id="ff148-201">若要新增更多指標，您可以提出遙測限制。</span><span class="sxs-lookup"><span data-stu-id="ff148-201">To add more indicators, you can raise the telemetry limit.</span></span> <span data-ttu-id="ff148-202">如需更精細的控制，請參閱[在 Application Insights 中取樣][Sampling in Application Insights]。</span><span class="sxs-lookup"><span data-stu-id="ff148-202">For more granular control, see [Sampling in Application Insights][Sampling in Application Insights].</span></span>

<span data-ttu-id="ff148-203">在部署之後，您可以觀看效能指標的[即時計量資料流][Live Metrics Stream]。</span><span class="sxs-lookup"><span data-stu-id="ff148-203">After deployment, you can watch a [Live Metrics Stream][Live Metrics Stream] of performance indicators.</span></span> <span data-ttu-id="ff148-204">此資料不會儲存起來 (&mdash;您正在檢視即時計量&mdash;)，但是可以收集遙測，以便稍後分析。</span><span class="sxs-lookup"><span data-stu-id="ff148-204">This data is not stored &mdash; you are viewing real-time metrics &mdash; but the telemetry can be collected and analyzed later.</span></span> <span data-ttu-id="ff148-205">即時資料流資料免費。</span><span class="sxs-lookup"><span data-stu-id="ff148-205">There is no charge for Live Stream data.</span></span>

<span data-ttu-id="ff148-206">Log Analytics 會依擷取至服務的資料 GB 量來計費。</span><span class="sxs-lookup"><span data-stu-id="ff148-206">Log Analytics is billed per gigabyte (GB) of data ingested into the service.</span></span> <span data-ttu-id="ff148-207">每月擷取至 Azure Log Analytics 服務的前 5 GB 資料為免費提供，而且資料會在 Log Analytics 工作區中免費保留 31 天。</span><span class="sxs-lookup"><span data-stu-id="ff148-207">The first 5 GB of data ingested to the Azure Log Analytics service every month is offered free, and the data is retained at no charge for first 31 days in your Log Analytics workspace.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ff148-208">後續步驟</span><span class="sxs-lookup"><span data-stu-id="ff148-208">Next steps</span></span>

<span data-ttu-id="ff148-209">請參閱下列資源，其設計訴求是要協助您開始使用自己的監視解決方案：</span><span class="sxs-lookup"><span data-stu-id="ff148-209">Check out these resources designed to help you get started with your own monitoring solution:</span></span>

<span data-ttu-id="ff148-210">[基本 Web 應用程式參考架構][Basic web application reference architecture]</span><span class="sxs-lookup"><span data-stu-id="ff148-210">[Basic web application reference architecture][Basic web application reference architecture]</span></span>

<span data-ttu-id="ff148-211">[開始監視 ASP.NET Web 應用程式][Start monitoring your ASP.NET Web Application]</span><span class="sxs-lookup"><span data-stu-id="ff148-211">[Start monitoring your ASP.NET Web Application][Start monitoring your ASP.NET Web Application]</span></span>

<span data-ttu-id="ff148-212">[收集關於 Azure 虛擬機器的資料][Collect data about Azure Virtual Machines]</span><span class="sxs-lookup"><span data-stu-id="ff148-212">[Collect data about Azure Virtual Machines][Collect data about Azure Virtual Machines]</span></span>

## <a name="related-resources"></a><span data-ttu-id="ff148-213">相關資源</span><span class="sxs-lookup"><span data-stu-id="ff148-213">Related resources</span></span>

<span data-ttu-id="ff148-214">[監視 Azure 應用程式和資源][Monitoring Azure applications and resources]</span><span class="sxs-lookup"><span data-stu-id="ff148-214">[Monitoring Azure applications and resources][Monitoring Azure applications and resources]</span></span>

<span data-ttu-id="ff148-215">[使用 Azure Application Insights 尋找並診斷執行階段例外狀況][Find and diagnose run-time exceptions with Azure Application Insights]</span><span class="sxs-lookup"><span data-stu-id="ff148-215">[Find and diagnose run-time exceptions with Azure Application Insights][Find and diagnose run-time exceptions with Azure Application Insights]</span></span>

<!-- links -->
[architecture]: ./images/architecture-diagram-app-monitoring.svg
[availability-tests]: /azure/application-insights/app-insights-monitor-web-app-availability
[application-insights]: /azure/application-insights/app-insights-overview
[azure-monitor]: /azure/monitoring-and-diagnostics/monitoring-overview-azure-monitor
[metrics]: /azure/monitoring-and-diagnostics/monitoring-supported-metrics
[Log Analytics 和其他服務]: /azure/log-analytics/log-analytics-azure-storage
[Log Analytics and other services]: /azure/log-analytics/log-analytics-azure-storage
[log-analytics]: /azure/log-analytics/log-analytics-overview
[Azure Log Analytics agent]: https://blogs.msdn.microsoft.com/sqlsecurity/2017/12/28/azure-log-analytics-oms-agent-now-collects-sql-server-audit-logs/
[application-insights-pricing]: https://azure.microsoft.com/pricing/details/application-insights/
[Application Insights SDKs]: /azure/application-insights/app-insights-asp-net
[Application Insights Status Monitor]: https://azure.microsoft.com/updates/application-insights-status-monitor-and-sdk-updated/
[analyzing data across sources]: /azure/log-analytics/log-analytics-dashboards
[sending proactive alerts]: /azure/log-analytics/log-analytics-alerts
[the Azure portal]: /azure/log-analytics/log-analytics-tutorial-dashboards
[Azure Log Analytics Query Language]: https://docs.loganalytics.io/docs/Learn
[cross-resource queries]: https://azure.microsoft.com/blog/query-across-resources/
[alerts]: /azure/monitoring-and-diagnostics/monitoring-overview-alerts
[Alerts (Preview)]: /azure/monitoring-and-diagnostics/monitoring-overview-unified-alerts
[Azure Monitor Data Source For Grafana]: https://grafana.com/plugins/grafana-azure-monitor-datasource
[Azure Automation]: /azure/automation/automation-intro
[ITSM solutions]: https://azure.microsoft.com/blog/itsm-connector-for-azure-is-now-generally-available/
[management solution]: /azure/monitoring/monitoring-solutions
[SLA]: https://azure.microsoft.com/support/legal/sla/app-service/v1_4/
[monitor its availability]: /azure/application-insights/app-insights-monitor-web-app-availability
[Resources, roles, and access control in Application Insights]: /azure/application-insights/app-insights-resources-roles-access-control
[basic metrics]: /azure/monitoring-and-diagnostics/monitoring-supported-metrics
[pricing]: https://azure.microsoft.com/pricing/calculator/#log-analyticsc126d8c1-ec9c-4e5b-9b51-4db95d06a9b1
[Sampling in Application Insights]: /azure/application-insights/app-insights-sampling
[Live Metrics Stream]: /azure/application-insights/app-insights-live-stream
[Basic web application reference architecture]: /azure/architecture/reference-architectures/app-service-web-app/basic-web-app#scalability-considerations
[Start monitoring your ASP.NET Web Application]: /azure/application-insights/quick-monitor-portal
[Collect data about Azure Virtual Machines]: /azure/log-analytics/log-analytics-quick-collect-azurevm
[Monitoring Azure applications and resources]: /azure/monitoring-and-diagnostics/monitoring-overview
[Find and diagnose run-time exceptions with Azure Application Insights]: /azure/application-insights/app-insights-tutorial-runtime-exceptions
[data-dog]: https://www.datadoghq.com/blog/azure-monitoring-enhancements/
[app-insights-limits]: /azure/azure-subscription-service-limits#application-insights-limits
[message-filtering]: /azure/application-insights/app-insights-api-filtering-sampling
[message-sampling]: /azure/application-insights/app-insights-sampling
