---
title: Azure 應用程式的失敗和災害復原
description: 方法中，Azure 的災害復原的概觀
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.openlocfilehash: f00341b06b8092c798d6260317226190cbace66b
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/17/2019
ms.locfileid: "59646518"
---
# <a name="failure-and-disaster-recovery-for-azure-applications"></a><span data-ttu-id="293a4-103">Azure 應用程式的失敗和災害復原</span><span class="sxs-lookup"><span data-stu-id="293a4-103">Failure and disaster recovery for Azure applications</span></span>

<span data-ttu-id="293a4-104">*嚴重損壞修復*是還原應用程式功能的重大損失的網路喚醒的程序。</span><span class="sxs-lookup"><span data-stu-id="293a4-104">*Disaster recovery* is the process of restoring application functionality in the wake of a catastrophic loss.</span></span>

<span data-ttu-id="293a4-105">您對功能會減少災害發生期間的容忍度是業務決策，不同的應用程式的下一步。</span><span class="sxs-lookup"><span data-stu-id="293a4-105">Your tolerance for reduced functionality during a disaster is a business decision that varies from one application to the next.</span></span> <span data-ttu-id="293a4-106">它是可接受的某些應用程式完全無法使用或部分可用以降低的功能或延遲一段時間的處理。</span><span class="sxs-lookup"><span data-stu-id="293a4-106">It might be acceptable for some applications to be completely unavailable or to be partially available with reduced functionality or delayed processing for a period of time.</span></span> <span data-ttu-id="293a4-107">其他應用程式，是無法接受任何功能會減少。</span><span class="sxs-lookup"><span data-stu-id="293a4-107">For other applications, any reduced functionality is unacceptable.</span></span>

## <a name="disaster-recovery-plan"></a><span data-ttu-id="293a4-108">災害復原計劃</span><span class="sxs-lookup"><span data-stu-id="293a4-108">Disaster recovery plan</span></span>

<span data-ttu-id="293a4-109">啟動建立復原計劃。</span><span class="sxs-lookup"><span data-stu-id="293a4-109">Start by creating a recovery plan.</span></span> <span data-ttu-id="293a4-110">已經過完整測試之後，即視為完成計劃。</span><span class="sxs-lookup"><span data-stu-id="293a4-110">The plan is considered complete after it has been fully tested.</span></span> <span data-ttu-id="293a4-111">包含人員、 程序和還原功能，您已定義為您的客戶服務等級協定 (SLA) 內所需的應用程式。</span><span class="sxs-lookup"><span data-stu-id="293a4-111">Include the people, processes, and applications needed to restore functionality within the service-level agreement (SLA) you've defined for your customers.</span></span>

<span data-ttu-id="293a4-112">請考慮下列建議時建立並測試您的災害復原計劃：</span><span class="sxs-lookup"><span data-stu-id="293a4-112">Consider the following suggestions when creating and testing your disaster recovery plan:</span></span>

- <span data-ttu-id="293a4-113">在您的方案，包括連絡支援人員，以及向上呈報問題的程序。</span><span class="sxs-lookup"><span data-stu-id="293a4-113">In your plan, include the process for contacting support and for escalating issues.</span></span> <span data-ttu-id="293a4-114">這項資訊有助於避免延長的停機，因為第一次解決復原程序。</span><span class="sxs-lookup"><span data-stu-id="293a4-114">This information will help to avoid prolonged downtime as you work out the recovery process for the first time.</span></span>
- <span data-ttu-id="293a4-115">評估應用程式失敗的商務影響。</span><span class="sxs-lookup"><span data-stu-id="293a4-115">Evaluate the business impact of application failures.</span></span>
- <span data-ttu-id="293a4-116">選擇關鍵任務應用程式的跨區域復原架構。</span><span class="sxs-lookup"><span data-stu-id="293a4-116">Choose a cross-region recovery architecture for mission-critical applications.</span></span>
- <span data-ttu-id="293a4-117">識別災害復原方案的特定擁有者，包括自動化和測試。</span><span class="sxs-lookup"><span data-stu-id="293a4-117">Identify a specific owner of the disaster recovery plan, including automation and testing.</span></span>
- <span data-ttu-id="293a4-118">文件的程序，尤其是任何手動步驟。</span><span class="sxs-lookup"><span data-stu-id="293a4-118">Document the process, especially any manual steps.</span></span>
- <span data-ttu-id="293a4-119">最大的程序自動化。</span><span class="sxs-lookup"><span data-stu-id="293a4-119">Automate the process as much as possible.</span></span>
- <span data-ttu-id="293a4-120">定期建立所有的參考和交易式的資料，以及測試備份還原的備份策略。</span><span class="sxs-lookup"><span data-stu-id="293a4-120">Establish a backup strategy for all reference and transactional data, and test backup restoration regularly.</span></span>
- <span data-ttu-id="293a4-121">設定適用於 Azure 的服務，供您的應用程式堆疊的警示。</span><span class="sxs-lookup"><span data-stu-id="293a4-121">Set up alerts for the stack of the Azure services consumed by your application.</span></span>
- <span data-ttu-id="293a4-122">訓練作業人員執行計劃。</span><span class="sxs-lookup"><span data-stu-id="293a4-122">Train operations staff to execute the plan.</span></span>
- <span data-ttu-id="293a4-123">執行常態性災害模擬來驗證和改善計劃。</span><span class="sxs-lookup"><span data-stu-id="293a4-123">Perform regular disaster simulations to validate and improve the plan.</span></span>

<span data-ttu-id="293a4-124">如果您使用[Azure Site Recovery](/azure/site-recovery/)來複寫虛擬機器 (Vm)，建立完全自動化的復原方案容錯移轉整個應用程式。</span><span class="sxs-lookup"><span data-stu-id="293a4-124">If you're using [Azure Site Recovery](/azure/site-recovery/) to replicate virtual machines (VMs), create a fully automated recovery plan to fail over the entire application.</span></span>

## <a name="manual-responses"></a><span data-ttu-id="293a4-125">手動回應</span><span class="sxs-lookup"><span data-stu-id="293a4-125">Manual responses</span></span>

<span data-ttu-id="293a4-126">雖然自動化是理想的災害復原的一些策略將需要手動的回應。</span><span class="sxs-lookup"><span data-stu-id="293a4-126">Although automation is ideal, some strategies for disaster recovery require manual responses.</span></span>

### <a name="alerts"></a><span data-ttu-id="293a4-127">警示</span><span class="sxs-lookup"><span data-stu-id="293a4-127">Alerts</span></span>

<span data-ttu-id="293a4-128">監視您的應用程式，注意可能需要主動介入的跡象。</span><span class="sxs-lookup"><span data-stu-id="293a4-128">Monitor your application for warning signs that may require proactive intervention.</span></span> <span data-ttu-id="293a4-129">例如，如果 Azure SQL Database 或 Azure Cosmos DB 一致地節流您的應用程式，您可能需要增加您的資料庫容量或最佳化查詢。</span><span class="sxs-lookup"><span data-stu-id="293a4-129">For example, if Azure SQL Database or Azure Cosmos DB consistently throttles your application, you might need to increase your database capacity or optimize your queries.</span></span> <span data-ttu-id="293a4-130">即使應用程式可能會以透明的方式處理節流錯誤，您的遙測仍應發出警示，讓您可以追蹤。</span><span class="sxs-lookup"><span data-stu-id="293a4-130">Even though the application might handle the throttling errors transparently, your telemetry should still raise an alert so that you can follow up.</span></span>

<span data-ttu-id="293a4-131">如需服務限制和配額臨界值，建議您設定 Azure 資源計量和診斷記錄的警示。</span><span class="sxs-lookup"><span data-stu-id="293a4-131">For service limits and quota thresholds, we recommend configuring alerts on Azure resources metrics and diagnostics logs.</span></span> <span data-ttu-id="293a4-132">可能的話，請設定警示的計量，也就是較低的延遲，比診斷記錄檔。</span><span class="sxs-lookup"><span data-stu-id="293a4-132">When possible, set up alerts on metrics, which are lower latency than diagnostics logs.</span></span>

<span data-ttu-id="293a4-133">透過 [資源健康狀態](/azure/service-health/resource-health-checks-resource-types)，Azure 會提供一些內建的健康狀態檢查，以協助您診斷 Azure 服務節流問題。</span><span class="sxs-lookup"><span data-stu-id="293a4-133">Through [Resource Health](/azure/service-health/resource-health-checks-resource-types), Azure provides some built-in health status checks that can help you diagnose Azure service throttling issues.</span></span>

### <a name="failover"></a><span data-ttu-id="293a4-134">容錯移轉</span><span class="sxs-lookup"><span data-stu-id="293a4-134">Failover</span></span>

<span data-ttu-id="293a4-135">設定每個 Azure 應用程式和其 Azure 服務的災害復原策略。</span><span class="sxs-lookup"><span data-stu-id="293a4-135">Configure a disaster recovery strategy for each Azure application and its Azure services.</span></span> <span data-ttu-id="293a4-136">可接受的部署策略，以支援災害復原可能因每個應用程式的所有元件所都需的 Sla。</span><span class="sxs-lookup"><span data-stu-id="293a4-136">Acceptable deployment strategies to support disaster recovery may vary based on the SLAs required for all components of each application.</span></span>  

<span data-ttu-id="293a4-137">Azure 提供不同的功能，以便進行手動容錯移轉，例如許多 Azure 服務內 [redis 快取的異地複寫](/azure/azure-cache-for-redis/cache-how-to-geo-replication)，或適用於自動化容錯移轉，例如 [SQL 自動容錯移轉群組](/azure/sql-database/sql-database-auto-failover-group)。</span><span class="sxs-lookup"><span data-stu-id="293a4-137">Azure provides different features within many Azure services to allow for manual failover, such as [redis cache geo-replicas](/azure/azure-cache-for-redis/cache-how-to-geo-replication), or for automated failover, such as [SQL auto-failover groups](/azure/sql-database/sql-database-auto-failover-group).</span></span> <span data-ttu-id="293a4-138">例如︰</span><span class="sxs-lookup"><span data-stu-id="293a4-138">For example:</span></span>

- <span data-ttu-id="293a4-139">主要使用的虛擬機器的應用程式，您可以使用 Azure Site Recovery 針對 web 和邏輯層。</span><span class="sxs-lookup"><span data-stu-id="293a4-139">For an application that mainly uses virtual machines, you can use Azure Site Recovery for the web and logic tiers.</span></span> <span data-ttu-id="293a4-140">如需詳細資訊，請參閱 < [Azure 至 Azure 災害復原架構](/azure/site-recovery/azure-to-azure-architecture)。</span><span class="sxs-lookup"><span data-stu-id="293a4-140">For more information, see [Azure to Azure disaster recovery architecture](/azure/site-recovery/azure-to-azure-architecture).</span></span> <span data-ttu-id="293a4-141">在 Vm 上的 SQL 伺服器，請使用[SQL Server Always On 可用性群組](/azure/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-availability-group-dr)。</span><span class="sxs-lookup"><span data-stu-id="293a4-141">For SQL Server on VMs, use [SQL Server Always On availability groups](/azure/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-availability-group-dr).</span></span>
- <span data-ttu-id="293a4-142">使用 App Service 和 Azure SQL Database 的應用程式，您可以使用較小的層 App Service 方案，在次要區域中，容錯移轉發生時的自動調整設定。</span><span class="sxs-lookup"><span data-stu-id="293a4-142">For an application that uses App Service and Azure SQL Database, you can use a smaller tier App Service plan configured in the secondary region, which autoscales when a failover occurs.</span></span> <span data-ttu-id="293a4-143">您可以使用 容錯移轉群組來放置資料庫層。</span><span class="sxs-lookup"><span data-stu-id="293a4-143">Use failover groups for the database tier.</span></span>

<span data-ttu-id="293a4-144">在任一案例中， [Azure 流量管理員](/azure/traffic-manager/traffic-manager-overview) 跨區域提供的自動容錯移轉的設定檔。</span><span class="sxs-lookup"><span data-stu-id="293a4-144">In either scenario, an [Azure Traffic Manager](/azure/traffic-manager/traffic-manager-overview) profile provides for the automated failover across regions.</span></span> <span data-ttu-id="293a4-145">[負載平衡器](/azure/load-balancer/load-balancer-overview)或是 [應用程式閘道](/azure/application-gateway/overview) 應該設定次要區域中可支援在容錯移轉時更快的可用性。</span><span class="sxs-lookup"><span data-stu-id="293a4-145">[Load balancers](/azure/load-balancer/load-balancer-overview) or [application gateways](/azure/application-gateway/overview) should be set up in the secondary region to support faster availability upon failover.</span></span>

### <a name="operational-readiness-testing"></a><span data-ttu-id="293a4-146">作業整備測試</span><span class="sxs-lookup"><span data-stu-id="293a4-146">Operational readiness testing</span></span>

<span data-ttu-id="293a4-147">針對至次要區域的容錯移轉及容錯回復到主要區域，請執行作業整備測試。</span><span class="sxs-lookup"><span data-stu-id="293a4-147">Perform an operational readiness test for failover to the secondary region and for failback to the primary region.</span></span> <span data-ttu-id="293a4-148">許多 Azure 服務支援手動容錯移轉或測試災害復原演練的容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="293a4-148">Many Azure services support manual failover or test failover for disaster recovery drills.</span></span> <span data-ttu-id="293a4-149">或者，您可以模擬中斷正在關閉或移除 Azure 服務。</span><span class="sxs-lookup"><span data-stu-id="293a4-149">Alternatively, you can simulate an outage by shutting down or removing Azure services.</span></span>

## <a name="application-failure"></a><span data-ttu-id="293a4-150">應用程式失敗</span><span class="sxs-lookup"><span data-stu-id="293a4-150">Application failure</span></span>

<span data-ttu-id="293a4-151">應用程式失敗是可修復或無法復原。</span><span class="sxs-lookup"><span data-stu-id="293a4-151">Application failures are either recoverable or nonrecoverable.</span></span> <span data-ttu-id="293a4-152">您可以緩和可復原的錯誤，但無法復原的錯誤將會關閉應用程式。</span><span class="sxs-lookup"><span data-stu-id="293a4-152">You can mitigate a recoverable error, but nonrecoverable errors will bring down the application.</span></span>

- <span data-ttu-id="293a4-153">某些故障問題可以解決無障礙地自動處理錯誤及採取替代動作。</span><span class="sxs-lookup"><span data-stu-id="293a4-153">Some failures can be addressed transparently by handling faults automatically and taking alternate actions.</span></span> <span data-ttu-id="293a4-154">比方說，Traffic Manager 會自動處理從虛擬機器主機中基礎硬體或作業系統軟體所造成的失敗。</span><span class="sxs-lookup"><span data-stu-id="293a4-154">For example, Traffic Manager automatically handles failures that result from the underlying hardware or operating system software in the host virtual machine.</span></span>
- <span data-ttu-id="293a4-155">但發生一些錯誤，應用程式可以繼續處理使用者要求，以降低的功能。</span><span class="sxs-lookup"><span data-stu-id="293a4-155">With some errors, the application can continue handling user requests with reduced functionality.</span></span>
- <span data-ttu-id="293a4-156">更嚴重的服務中斷可能會使應用程式無法使用。</span><span class="sxs-lookup"><span data-stu-id="293a4-156">More severe service disruptions might render the application unavailable.</span></span>

<span data-ttu-id="293a4-157">設計良好的系統將服務層級的責任&mdash;在設計階段和執行階段。</span><span class="sxs-lookup"><span data-stu-id="293a4-157">A well-designed system separates responsibilities at the service level &mdash; at design time and at runtime.</span></span> <span data-ttu-id="293a4-158">這種區隔可防止關閉整個應用程式相依的服務中斷。</span><span class="sxs-lookup"><span data-stu-id="293a4-158">This separation prevents a dependent service disruption from bringing down the entire application.</span></span> <span data-ttu-id="293a4-159">例如，請考慮下列模組的 web 商務應用程式：</span><span class="sxs-lookup"><span data-stu-id="293a4-159">For example, consider a web commerce application with the following modules:</span></span>

![將連結加入到圖案](./_images/disaster-recovery.png)

<span data-ttu-id="293a4-161">如果裝載訂單的資料庫關閉時，「 訂單處理服務無法處理銷售交易。</span><span class="sxs-lookup"><span data-stu-id="293a4-161">If the database for hosting orders goes down, the Order Processing service can't process sales transactions.</span></span> <span data-ttu-id="293a4-162">根據架構中，它可能無法提交訂單 」 和 「 訂單處理服務繼續順利執行。</span><span class="sxs-lookup"><span data-stu-id="293a4-162">Depending on the architecture, it might be impossible for the Order Submission and Order Processing services to continue.</span></span> <span data-ttu-id="293a4-163">不過，如果產品資料儲存在不同的位置中，產品目錄就是仍然可用，即使應用程式的其他部分可能會無法使用。</span><span class="sxs-lookup"><span data-stu-id="293a4-163">However, if product data is stored in a different location, the Product Catalog is still available, even though other parts of the application might be unavailable.</span></span>

<span data-ttu-id="293a4-164">它由您決定如何應用程式將會通知使用者發生任何暫時性問題，並建置適當的通知系統。</span><span class="sxs-lookup"><span data-stu-id="293a4-164">It's up to you to determine how the application will inform users of any temporary problems and to build appropriate notifications into the system.</span></span> <span data-ttu-id="293a4-165">在上述範例中，來檢視產品，並將它們新增至購物車，可能會允許應用程式。</span><span class="sxs-lookup"><span data-stu-id="293a4-165">In the previous example, the application might allow for viewing products and for adding them to a shopping cart.</span></span> <span data-ttu-id="293a4-166">不過，當客戶嘗試進行購買，應用程式應該通知它們，訂購功能暫時無法使用。</span><span class="sxs-lookup"><span data-stu-id="293a4-166">However, when the customer attempts to make a purchase, the application should notify them that the ordering functionality is temporarily unavailable.</span></span> <span data-ttu-id="293a4-167">雖然不理想的客戶，這種方法可防止全應用程式的服務中斷。</span><span class="sxs-lookup"><span data-stu-id="293a4-167">Although not ideal for the customer, this approach prevents an application-wide service disruption.</span></span>

## <a name="data-corruption-and-restoration"></a><span data-ttu-id="293a4-168">資料損毀和還原</span><span class="sxs-lookup"><span data-stu-id="293a4-168">Data corruption and restoration</span></span>

<span data-ttu-id="293a4-169">如果資料存放區失敗，可能有資料不一致時它再次可供使用，尤其是在已複寫資料。</span><span class="sxs-lookup"><span data-stu-id="293a4-169">If a data store fails, there might be data inconsistencies when it becomes available again, especially if the data was replicated.</span></span> <span data-ttu-id="293a4-170">了解復原時間目標 (RTO) 和復原點目標 (RPO) 的複寫的資料存放區可協助您預測的資料遺失量。</span><span class="sxs-lookup"><span data-stu-id="293a4-170">Understanding the recovery time objective (RTO) and recovery point objective (RPO) of replicated data stores can help you predict the amount of data loss.</span></span>

<span data-ttu-id="293a4-171">若要了解是否要以手動方式或 Microsoft 啟動跨區域容錯移轉，請檢閱 Azure 服務 Sla。</span><span class="sxs-lookup"><span data-stu-id="293a4-171">To understand whether the cross-regional failover is started manually or by Microsoft, review the Azure service SLAs.</span></span> <span data-ttu-id="293a4-172">對於服務沒有 Sla 的跨區域容錯移轉，Microsoft 通常會決定何時要容錯移轉，但通常優先復原主要區域中的資料。</span><span class="sxs-lookup"><span data-stu-id="293a4-172">For services with no SLAs for cross-regional failover, Microsoft typically decides when to fail over and usually prioritizes recovery of data in the primary region.</span></span> <span data-ttu-id="293a4-173">如果主要區域中的資料會被視為無法復原的 Microsoft 會容錯移轉到次要區域。</span><span class="sxs-lookup"><span data-stu-id="293a4-173">If data in the primary region is deemed unrecoverable, Microsoft fails over to the secondary region.</span></span>

### <a name="restoring-data-from-backups"></a><span data-ttu-id="293a4-174">從備份還原資料</span><span class="sxs-lookup"><span data-stu-id="293a4-174">Restoring data from backups</span></span>

<span data-ttu-id="293a4-175">備份可保護您免於因意外刪除或資料損毀而遺失應用程式的元件。</span><span class="sxs-lookup"><span data-stu-id="293a4-175">Backups protect you from losing a component of the application because of accidental deletion or data corruption.</span></span> <span data-ttu-id="293a4-176">它們會保留從較早的時間，將它還原，您可以使用元件的功能版本。</span><span class="sxs-lookup"><span data-stu-id="293a4-176">They preserve a functional version of the component from an earlier time, which you can use to restore it.</span></span>

<span data-ttu-id="293a4-177">災害復原策略不會取代備份，但應用程式資料的定期備份支援一些災害復原案例。</span><span class="sxs-lookup"><span data-stu-id="293a4-177">Disaster recovery strategies are not a replacement for backups, but regular backups of application data support some disaster recovery scenarios.</span></span> <span data-ttu-id="293a4-178">您的備份儲存體選擇應根據災害復原策略。</span><span class="sxs-lookup"><span data-stu-id="293a4-178">Your backup storage choices should be based on your disaster recovery strategy.</span></span>

<span data-ttu-id="293a4-179">執行備份程序的頻率會決定您的 RPO。</span><span class="sxs-lookup"><span data-stu-id="293a4-179">The frequency of running the backup process determines your RPO.</span></span> <span data-ttu-id="293a4-180">比方說，如果您每小時執行備份，災害發生在備份之前的兩分鐘，您將會遺失的 58 分鐘資料。</span><span class="sxs-lookup"><span data-stu-id="293a4-180">For example, if you perform hourly backups and a disaster occurs two minutes before the backup, you will lose 58 minutes of data.</span></span> <span data-ttu-id="293a4-181">您的災害復原計劃應該包含您如何解決遺失的資料。</span><span class="sxs-lookup"><span data-stu-id="293a4-181">Your disaster recovery plan should include how you will address lost data.</span></span>

<span data-ttu-id="293a4-182">通常會在另一個存放區中的參考資料的一個資料存放區中的資料。</span><span class="sxs-lookup"><span data-stu-id="293a4-182">It's common for data in one data store to reference data in another store.</span></span> <span data-ttu-id="293a4-183">例如，假設 SQL Database 具有資料行連結至 Azure 儲存體中的 blob。</span><span class="sxs-lookup"><span data-stu-id="293a4-183">For example, consider a SQL Database with a column that links to a blob in Azure Storage.</span></span> <span data-ttu-id="293a4-184">如果備份未同時進行，則資料庫可能有失敗前未備份 blob 的指標。</span><span class="sxs-lookup"><span data-stu-id="293a4-184">If backups don't happen simultaneously, the database might have a pointer to a blob that wasn't backed up before the failure.</span></span> <span data-ttu-id="293a4-185">在應用程式或災害復原計畫必須實作程序來處理復原後的這項不一致。</span><span class="sxs-lookup"><span data-stu-id="293a4-185">The application or the disaster recovery plan must implement processes to handle this inconsistency after a recovery.</span></span>

> [!NOTE]
> <span data-ttu-id="293a4-186">在某些情況下，例如使用備份的 vm [Azure 備份](/azure/backup/backup-azure-vms-first-look-arm)，您可以只從相同的區域中的備份進行還原。</span><span class="sxs-lookup"><span data-stu-id="293a4-186">In some scenarios, such as that of VMs backed up using [Azure Backup](/azure/backup/backup-azure-vms-first-look-arm), you can restore only from a backup in the same region.</span></span> <span data-ttu-id="293a4-187">其他 Azure 服務，例如[redis Azure 快取](/azure/azure-cache-for-redis/cache-how-to-geo-replication)，提供異地複寫的備份，您可以使用跨區域還原服務。</span><span class="sxs-lookup"><span data-stu-id="293a4-187">Other Azure services, such as [Azure Cache for Redis](/azure/azure-cache-for-redis/cache-how-to-geo-replication), provide geo-replicated backups, which you can use to restore services across regions.</span></span>

### <a name="azure-storage-and-azure-sql-database"></a><span data-ttu-id="293a4-188">Azure 儲存體和 Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="293a4-188">Azure Storage and Azure SQL Database</span></span>

<span data-ttu-id="293a4-189">Azure 會自動儲存三次內的不同容錯網域的 Azure 儲存體和 SQL Database 的資料，相同的區域中。</span><span class="sxs-lookup"><span data-stu-id="293a4-189">Azure automatically stores Azure Storage and SQL Database data three times within different fault domains in the same region.</span></span> <span data-ttu-id="293a4-190">如果您使用異地複寫，資料會在不同的區域中額外儲存三次。</span><span class="sxs-lookup"><span data-stu-id="293a4-190">If you use geo-replication, the data is stored three additional times in a different region.</span></span> <span data-ttu-id="293a4-191">不過，如果資料已損毀或刪除主要複本中 （例如，因為使用者錯誤），所做的變更會複寫到其他複本。</span><span class="sxs-lookup"><span data-stu-id="293a4-191">However, if the data is corrupted or deleted in the primary copy (for example, because of user error), the changes replicate to the other copies.</span></span>

<span data-ttu-id="293a4-192">您有兩個選項可管理潛在資料損毀或刪除：</span><span class="sxs-lookup"><span data-stu-id="293a4-192">You have two options for managing potential data corruption or deletion:</span></span>

- <span data-ttu-id="293a4-193">**建立自訂的備份策略。**</span><span class="sxs-lookup"><span data-stu-id="293a4-193">**Create a custom backup strategy.**</span></span> <span data-ttu-id="293a4-194">您可以將備份儲存在 Azure 或內部部署，視您的商務需求和控管規定而定。</span><span class="sxs-lookup"><span data-stu-id="293a4-194">You can store your backups in Azure or on-premises, depending on your business requirements and governance regulations.</span></span>
- <span data-ttu-id="293a4-195">**使用還原時間點選項**來復原 SQL 資料庫。</span><span class="sxs-lookup"><span data-stu-id="293a4-195">**Use the point-in-time restore option** to recover a SQL Database.</span></span>

#### <a name="azure-storage-recovery"></a><span data-ttu-id="293a4-196">Azure 儲存體復原</span><span class="sxs-lookup"><span data-stu-id="293a4-196">Azure Storage recovery</span></span>

<span data-ttu-id="293a4-197">您可以開發自訂備份程序的 Azure 儲存體，或使用某個協力廠商備份工具。</span><span class="sxs-lookup"><span data-stu-id="293a4-197">You can develop a custom backup process for Azure Storage or use one of many third-party backup tools.</span></span>

<span data-ttu-id="293a4-198">Azure 儲存體提供資料恢復功能，透過自動化複本，但它不會防止應用程式程式碼或使用者損毀資料。</span><span class="sxs-lookup"><span data-stu-id="293a4-198">Azure Storage provides data resiliency through automated replicas, but it doesn't prevent application code or users from corrupting data.</span></span> <span data-ttu-id="293a4-199">維護資料精確度之後應用程式或使用者錯誤需要更進階的技術，例如將資料複製到次要儲存體位置，使用稽核記錄。</span><span class="sxs-lookup"><span data-stu-id="293a4-199">Maintaining data fidelity after application or user error requires more advanced techniques, such as copying the data to a secondary storage location with an audit log.</span></span> <span data-ttu-id="293a4-200">您有幾種選項：</span><span class="sxs-lookup"><span data-stu-id="293a4-200">You have several options:</span></span>

- [<span data-ttu-id="293a4-201">**區塊 blob。**</span><span class="sxs-lookup"><span data-stu-id="293a4-201">**Block blobs.**</span></span>](/rest/api/storageservices/understanding-block-blobs--append-blobs--and-page-blobs) <span data-ttu-id="293a4-202">建立每個區塊 Blob 的時間點快照集。</span><span class="sxs-lookup"><span data-stu-id="293a4-202">Create a point-in-time snapshot of each block blob.</span></span> <span data-ttu-id="293a4-203">每個快照集，您只需支付儲存在 blob 中的差異，自先前的快照集狀態所需的儲存體。</span><span class="sxs-lookup"><span data-stu-id="293a4-203">For each snapshot, you are charged only for the storage required to store the differences within the blob since the previous snapshot state.</span></span> <span data-ttu-id="293a4-204">因此我們建議您複製到另一個 blob 或甚至是另一個儲存體帳戶，是取決於原始的 blob，快照集。</span><span class="sxs-lookup"><span data-stu-id="293a4-204">The snapshots are dependent on the original blob, so we recommend copying to another blob or even to another storage account.</span></span> <span data-ttu-id="293a4-205">這個方法可確保備份資料會受到保護，防止被意外刪除。</span><span class="sxs-lookup"><span data-stu-id="293a4-205">This approach ensures that backup data is protected against accidental deletion.</span></span> <span data-ttu-id="293a4-206">使用[AzCopy](/azure/storage/common/storage-use-azcopy)或是[Azure PowerShell](/azure/storage/common/storage-powershell-guide-full)將 blob 複製到另一個儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="293a4-206">Use [AzCopy](/azure/storage/common/storage-use-azcopy) or [Azure PowerShell](/azure/storage/common/storage-powershell-guide-full) to copy the blobs to another storage account.</span></span>

    <span data-ttu-id="293a4-207">如需詳細資訊，請參閱 [建立 Blob 的快照集](/rest/api/storageservices/creating-a-snapshot-of-a-blob)。</span><span class="sxs-lookup"><span data-stu-id="293a4-207">For more information, see [Creating a Snapshot of a Blob](/rest/api/storageservices/creating-a-snapshot-of-a-blob).</span></span>

- [<span data-ttu-id="293a4-208">**Azure 檔案。**</span><span class="sxs-lookup"><span data-stu-id="293a4-208">**Azure Files.**</span></span>](/azure/storage/files/storage-files-introduction) <span data-ttu-id="293a4-209">使用[共用快照集](/azure/storage/files/storage-snapshots-files)，AzCopy 或 PowerShell，將您的檔案複製到另一個儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="293a4-209">Use [share snapshots](/azure/storage/files/storage-snapshots-files), AzCopy, or PowerShell to copy your files to another storage account.</span></span>
- [<span data-ttu-id="293a4-210">**Azure 資料表儲存體中。**</span><span class="sxs-lookup"><span data-stu-id="293a4-210">**Azure Table storage.**</span></span>](/azure/storage/tables/table-storage-overview) <span data-ttu-id="293a4-211">使用 AzCopy 可將資料表資料匯出到位於其他區域的其他儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="293a4-211">Use AzCopy to export the table data into another storage account in another region.</span></span>

#### <a name="sql-database-recovery"></a><span data-ttu-id="293a4-212">SQL Database 復原</span><span class="sxs-lookup"><span data-stu-id="293a4-212">SQL Database recovery</span></span>

<span data-ttu-id="293a4-213">若要防止資料遺失，SQL Database 自動保護您的企業會執行完整資料庫備份的組合每週、 每小時、 差異資料庫備份和交易記錄備份每隔 5 到 10 分鐘的時間。</span><span class="sxs-lookup"><span data-stu-id="293a4-213">To protect your business from data loss, SQL Database automatically performs a combination of full database backups weekly, differential database backups hourly, and transaction log backups every 5 to 10 minutes.</span></span> <span data-ttu-id="293a4-214">對於 Basic、 Standard 和 Premium SQL Database 層中，使用時間點還原到資料庫加入至較早的時間。</span><span class="sxs-lookup"><span data-stu-id="293a4-214">For the Basic, Standard, and Premium SQL Database tiers, use point-in-time restore to restore a database to an earlier time.</span></span> <span data-ttu-id="293a4-215">如需詳細資訊，請參閱下列文章：</span><span class="sxs-lookup"><span data-stu-id="293a4-215">See the following articles for more information:</span></span>

- [<span data-ttu-id="293a4-216">使用自動資料庫備份復原 Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="293a4-216">Recover an Azure SQL database using automated database backups</span></span>](/azure/sql-database/sql-database-recovery-using-backups)
- [<span data-ttu-id="293a4-217">使用 Azure SQL Database 的商務持續性概觀</span><span class="sxs-lookup"><span data-stu-id="293a4-217">Overview of business continuity with Azure SQL Database</span></span>](/azure/sql-database/sql-database-business-continuity)

<span data-ttu-id="293a4-218">另一個選項是用於 SQL Database，其會自動將資料庫變更複寫到相同或不同 Azure 區域中的次要資料庫的作用中異地複寫。</span><span class="sxs-lookup"><span data-stu-id="293a4-218">Another option is to use active geo-replication for SQL Database, which automatically replicates database changes to secondary databases in the same or different Azure region.</span></span> <span data-ttu-id="293a4-219">如需詳細資訊，請參閱 <<c0> [ 建立和使用主動式異地複寫](/azure/sql-database/sql-database-active-geo-replication)。</span><span class="sxs-lookup"><span data-stu-id="293a4-219">For more information, see [Creating and using active geo-replication](/azure/sql-database/sql-database-active-geo-replication).</span></span>

<span data-ttu-id="293a4-220">您也可以使用較為手動的方式進行備份和還原：</span><span class="sxs-lookup"><span data-stu-id="293a4-220">You can also use a more manual approach for backup and restore:</span></span>

- <span data-ttu-id="293a4-221">使用**資料庫複製**命令來建立資料庫的備份副本，具有交易一致性。</span><span class="sxs-lookup"><span data-stu-id="293a4-221">Use the **DATABASE COPY** command to create a backup copy of the database with transactional consistency.</span></span>
- <span data-ttu-id="293a4-222">使用 Azure SQL Database 匯入/匯出服務，可支援將資料庫匯出到 BACPAC 檔案 （包含您的資料庫結構描述和相關聯的資料壓縮檔案） 儲存在 Azure Blob 儲存體中。</span><span class="sxs-lookup"><span data-stu-id="293a4-222">Use the Azure SQL Database Import/Export Service, which supports exporting databases to BACPAC files (compressed files containing your database schema and associated data) that are stored in Azure Blob storage.</span></span> <span data-ttu-id="293a4-223">若要防止全區域服務中斷，將 BACPAC 檔案複製到替代區域。</span><span class="sxs-lookup"><span data-stu-id="293a4-223">To protect against a region-wide service disruption, copy the BACPAC files to an alternate region.</span></span>

### <a name="sql-server-on-vms"></a><span data-ttu-id="293a4-224">虛擬機器上的 SQL Server</span><span class="sxs-lookup"><span data-stu-id="293a4-224">SQL Server on VMs</span></span>

<span data-ttu-id="293a4-225">在 Vm 上執行的 SQL Server，您有兩個選項： 傳統備份和記錄傳送。</span><span class="sxs-lookup"><span data-stu-id="293a4-225">For SQL Server running on VMs, you have two options: traditional backups and log shipping.</span></span>

- <span data-ttu-id="293a4-226">使用傳統備份時，您可以還原至特定點時間，但復原程序緩慢。</span><span class="sxs-lookup"><span data-stu-id="293a4-226">With traditional backups, you can restore to a specific point in time, but the recovery process is slow.</span></span> <span data-ttu-id="293a4-227">還原傳統備份需要初始完整備份開始，然後套用所有增量備份。</span><span class="sxs-lookup"><span data-stu-id="293a4-227">Restoring traditional backups requires that you start with an initial full backup and then apply any incremental backups.</span></span>
- <span data-ttu-id="293a4-228">您可以設定記錄傳送工作階段的記錄備份還原延遲。</span><span class="sxs-lookup"><span data-stu-id="293a4-228">You can configure a log shipping session to delay the restore of log backups.</span></span> <span data-ttu-id="293a4-229">這會提供一個視窗，以從主要複本上的錯誤復原。</span><span class="sxs-lookup"><span data-stu-id="293a4-229">This provides a window to recover from errors made on the primary replica.</span></span>

### <a name="azure-database-for-mysql-and-azure-database-for-postgresql"></a><span data-ttu-id="293a4-230">Azure Database for MySQL 和適用於 PostgreSQL 的 Azure 資料庫</span><span class="sxs-lookup"><span data-stu-id="293a4-230">Azure Database for MySQL and Azure Database for PostgreSQL</span></span>

<span data-ttu-id="293a4-231">在適用於 MySQL 的 Azure 資料庫和適用於 PostgreSQL 的 Azure 資料庫中，資料庫服務會自動將備份每隔五分鐘。</span><span class="sxs-lookup"><span data-stu-id="293a4-231">In Azure Database for MySQL and Azure Database for PostgreSQL, the database service automatically makes a backup every five minutes.</span></span> <span data-ttu-id="293a4-232">您可以使用這些自動化的備份來還原伺服器和資料庫從較早時間點的時間到新的伺服器。</span><span class="sxs-lookup"><span data-stu-id="293a4-232">You can use these automated backups to restore the server and its databases from an earlier point in time to a new server.</span></span> <span data-ttu-id="293a4-233">如需詳細資訊，請參閱</span><span class="sxs-lookup"><span data-stu-id="293a4-233">For more information, see:</span></span>

- [<span data-ttu-id="293a4-234">如何使用 Azure 入口網站，在適用於 MySQL 的 Azure 資料庫中備份和還原伺服器</span><span class="sxs-lookup"><span data-stu-id="293a4-234">How to back up and restore a server in Azure Database for MySQL by using the Azure portal</span></span>](/azure/mysql/howto-restore-server-portal)
- [<span data-ttu-id="293a4-235">如何備份及還原使用 Azure 入口網站適用於 PostgreSQL 的 Azure 資料庫中的伺服器</span><span class="sxs-lookup"><span data-stu-id="293a4-235">How to back up and restore a server in Azure Database for PostgreSQL using the Azure portal</span></span>](/azure/postgresql/howto-restore-server-portal)

### <a name="azure-cosmos-db"></a><span data-ttu-id="293a4-236">Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="293a4-236">Azure Cosmos DB</span></span>

<span data-ttu-id="293a4-237">Cosmos DB 會自動將固定間隔的備份。</span><span class="sxs-lookup"><span data-stu-id="293a4-237">Cosmos DB automatically makes a backup at regular intervals.</span></span> <span data-ttu-id="293a4-238">備份會儲存在另一個儲存體服務，而且會全域複寫到防範區域性災害提供防護。</span><span class="sxs-lookup"><span data-stu-id="293a4-238">Backups are stored separately in another storage service and are replicated globally to protect against regional disasters.</span></span> <span data-ttu-id="293a4-239">如果您不小心刪除資料庫或集合，您可以提出支援票證或連絡 Azure 支援，要求從最新的自動備份還原資料。</span><span class="sxs-lookup"><span data-stu-id="293a4-239">If you accidentally delete your database or collection, you can file a support ticket or call Azure support to restore the data from the last automatic backup.</span></span> <span data-ttu-id="293a4-240">如需詳細資訊，請參閱 <<c0> [ 線上備份及 Azure Cosmos DB 中的隨選還原](/azure/cosmos-db/online-backup-and-restore)。</span><span class="sxs-lookup"><span data-stu-id="293a4-240">For more information, see [Online backup and on-demand restore in Azure Cosmos DB](/azure/cosmos-db/online-backup-and-restore).</span></span>

### <a name="azure-virtual-machines"></a><span data-ttu-id="293a4-241">Azure 虛擬機器</span><span class="sxs-lookup"><span data-stu-id="293a4-241">Azure Virtual Machines</span></span>

<span data-ttu-id="293a4-242">若要防止應用程式錯誤或意外刪除的 Azure 虛擬機器，使用[Azure 備份](/azure/backup/)。</span><span class="sxs-lookup"><span data-stu-id="293a4-242">To protect Azure Virtual Machines from application errors or accidental deletion, use [Azure Backup](/azure/backup/).</span></span> <span data-ttu-id="293a4-243">建立的備份是一致的跨多個 VM 磁碟。</span><span class="sxs-lookup"><span data-stu-id="293a4-243">The created backups are consistent across multiple VM disks.</span></span> <span data-ttu-id="293a4-244">此外，Azure 備份保存庫可以跨區域，以支援從地區耗損復原複寫。</span><span class="sxs-lookup"><span data-stu-id="293a4-244">In addition, the Azure Backup vault can be replicated across regions to support recovery from a regional loss.</span></span>

## <a name="network-outage"></a><span data-ttu-id="293a4-245">網路中斷</span><span class="sxs-lookup"><span data-stu-id="293a4-245">Network outage</span></span>

<span data-ttu-id="293a4-246">Azure 網路的組件無法存取時，您可能會無法存取您的應用程式或資料。</span><span class="sxs-lookup"><span data-stu-id="293a4-246">When parts of the Azure network are inaccessible, you might not be able to access your application or data.</span></span> <span data-ttu-id="293a4-247">在此情況下，建議您設計災害復原策略，來執行大部分的應用程式以降低的功能。</span><span class="sxs-lookup"><span data-stu-id="293a4-247">In this situation, we recommend designing the disaster recovery strategy to run most applications with reduced functionality.</span></span>

<span data-ttu-id="293a4-248">如果降低功能不是一個選項，則剩餘的選項會為應用程式停機或容錯移轉至替代區域。</span><span class="sxs-lookup"><span data-stu-id="293a4-248">If reducing functionality isn't an option, the remaining options are application downtime or failover to an alternate region.</span></span>

<span data-ttu-id="293a4-249">在功能會減少的案例：</span><span class="sxs-lookup"><span data-stu-id="293a4-249">In a reduced functionality scenario:</span></span>

- <span data-ttu-id="293a4-250">如果您的應用程式無法存取其資料，因為 Azure 網路中斷，您可以使用快取的資料在本機執行具有降低的應用程式功能。</span><span class="sxs-lookup"><span data-stu-id="293a4-250">If your application can't access its data because of an Azure network outage, you might be able to run locally with reduced application functionality by using cached data.</span></span>
- <span data-ttu-id="293a4-251">您可以將資料儲存在替代位置，直到恢復連線為止。</span><span class="sxs-lookup"><span data-stu-id="293a4-251">You might be able to store data in an alternate location until connectivity is restored.</span></span>

## <a name="dependent-service-failure"></a><span data-ttu-id="293a4-252">相依服務失敗</span><span class="sxs-lookup"><span data-stu-id="293a4-252">Dependent service failure</span></span>

<span data-ttu-id="293a4-253">針對每個相依的服務，您應該了解服務中斷，以及應用程式會回應的方式的影響。</span><span class="sxs-lookup"><span data-stu-id="293a4-253">For each dependent service, you should understand the implications of a service disruption and the way that the application will respond.</span></span> <span data-ttu-id="293a4-254">許多服務都包含支援復原和可用性，因此獨立評估每個服務時可能會提高嚴重損壞修復計劃的功能。</span><span class="sxs-lookup"><span data-stu-id="293a4-254">Many services include features that support resiliency and availability, so evaluating each service independently is likely to improve your disaster recovery plan.</span></span> <span data-ttu-id="293a4-255">例如，支援 Azure 事件中樞[容錯移轉](/azure/event-hubs/event-hubs-geo-dr#setup-and-failover-flow)次要命名空間。</span><span class="sxs-lookup"><span data-stu-id="293a4-255">For example, Azure Event Hubs supports [failing over](/azure/event-hubs/event-hubs-geo-dr#setup-and-failover-flow) to the secondary namespace.</span></span>

## <a name="region-wide-service-disruptions"></a><span data-ttu-id="293a4-256">全區域服務中斷</span><span class="sxs-lookup"><span data-stu-id="293a4-256">Region-wide service disruptions</span></span>

<span data-ttu-id="293a4-257">許多失敗是可管理的相同 Azure 區域內。</span><span class="sxs-lookup"><span data-stu-id="293a4-257">Many failures are manageable within the same Azure region.</span></span> <span data-ttu-id="293a4-258">不過，不太可能全區域服務中斷事件時，無法使用本機備援複本的資料。</span><span class="sxs-lookup"><span data-stu-id="293a4-258">However, in the unlikely event of a region-wide service disruption, the locally redundant copies of your data aren't available.</span></span> <span data-ttu-id="293a4-259">如果您已啟用異地複寫，但是有額外三份您的 blob 和資料表在不同的區域。</span><span class="sxs-lookup"><span data-stu-id="293a4-259">If you've enabled geo-replication, there are three additional copies of your blobs and tables in a different region.</span></span> <span data-ttu-id="293a4-260">如果 Microsoft 宣告此區域遺失，Azure 會重新對應到次要區域的所有 DNS 項目。</span><span class="sxs-lookup"><span data-stu-id="293a4-260">If Microsoft declares the region lost, Azure remaps all the DNS entries to the secondary region.</span></span>

> [!NOTE]
> <span data-ttu-id="293a4-261">此程序只會發生全區域服務中斷，並不在您的控制項內。</span><span class="sxs-lookup"><span data-stu-id="293a4-261">This process occurs only for region-wide service disruptions and is not within your control.</span></span> <span data-ttu-id="293a4-262">請考慮使用 [Azure Site Recovery](/azure/site-recovery/) 來達成更好的 RPO 和 RTO。</span><span class="sxs-lookup"><span data-stu-id="293a4-262">Consider using [Azure Site Recovery](/azure/site-recovery/) to achieve better RPO and RTO.</span></span> <span data-ttu-id="293a4-263">使用 Site Recovery，您決定什麼是可接受的中斷，以及何時要容錯移轉至複寫的 Vm。</span><span class="sxs-lookup"><span data-stu-id="293a4-263">Using Site Recovery, you decide what is an acceptable outage and when to fail over to the replicated VMs.</span></span>

<span data-ttu-id="293a4-264">您的回應，全區域服務中斷的情況取決於您的部署和災害復原計畫。</span><span class="sxs-lookup"><span data-stu-id="293a4-264">Your response to a region-wide service disruption depends on your deployment and your disaster recovery plan.</span></span>

- <span data-ttu-id="293a4-265">成本控制策略的非關鍵性的應用程式，不需要保證的復原時間，可能會合理重新部署到不同的區域。</span><span class="sxs-lookup"><span data-stu-id="293a4-265">As a cost-control strategy, for non-critical applications that don't require a guaranteed recovery time, it might make sense to redeploy to a different region.</span></span>
- <span data-ttu-id="293a4-266">裝載於另一個區域，與已部署的角色，但不將流量分散到區域應用程式 (*主動/被動部署*)，切換到次要的託管服務，在替代區域。</span><span class="sxs-lookup"><span data-stu-id="293a4-266">For applications that are hosted in another region with deployed roles but don't distribute traffic across regions (*active/passive deployment*), switch to the secondary hosted service in the alternate region.</span></span>
- <span data-ttu-id="293a4-267">在另一個區域中有完整規模的次要部署的應用程式 (*主動/主動部署*)，將流量路由傳送到該區域。</span><span class="sxs-lookup"><span data-stu-id="293a4-267">For applications that have a full-scale secondary deployment in another region (*active/active deployment*), route traffic to that region.</span></span>

<span data-ttu-id="293a4-268">若要深入了解從全區域服務中斷復原，請參閱[從全區域服務中斷復原](../resiliency/recovery-loss-azure-region.md)。</span><span class="sxs-lookup"><span data-stu-id="293a4-268">To learn more about recovering from a region-wide service disruption, see [Recover from a region-wide service disruption](../resiliency/recovery-loss-azure-region.md).</span></span>

### <a name="vm-recovery"></a><span data-ttu-id="293a4-269">VM 復原</span><span class="sxs-lookup"><span data-stu-id="293a4-269">VM recovery</span></span>

<span data-ttu-id="293a4-270">針對關鍵的應用程式，規劃復原 Vm 發生全區域服務中斷的情況。</span><span class="sxs-lookup"><span data-stu-id="293a4-270">For critical apps, plan for recovering VMs in the event of a region-wide service disruption.</span></span>

- <span data-ttu-id="293a4-271">使用 Azure 備份或另一種備份方法來建立跨區域備份應用程式一致的。</span><span class="sxs-lookup"><span data-stu-id="293a4-271">Use Azure Backup or another backup method to create cross-region backups that are application consistent.</span></span> <span data-ttu-id="293a4-272">（在建立時必須設定的備份保存庫的複寫）。</span><span class="sxs-lookup"><span data-stu-id="293a4-272">(Replication of the Backup vault must be configured at the time of creation.)</span></span>
- <span data-ttu-id="293a4-273">使用 Site Recovery 來複寫跨區域，只要按一下應用程式容錯移轉和容錯移轉測試。</span><span class="sxs-lookup"><span data-stu-id="293a4-273">Use Site Recovery to replicate across regions for one-click application failover and failover testing.</span></span>
- <span data-ttu-id="293a4-274">您可以使用流量管理員自動使用者流量容錯移轉到另一個區域。</span><span class="sxs-lookup"><span data-stu-id="293a4-274">Use Traffic Manager to automate user traffic failover to another region.</span></span>

<span data-ttu-id="293a4-275">若要進一步了解，請參閱[從全區域服務中斷的情況中，虛擬機器復原](../resiliency/recovery-loss-azure-region.md#virtual-machines)。</span><span class="sxs-lookup"><span data-stu-id="293a4-275">To learn more, see [Recover from a region-wide service disruption, Virtual machines](../resiliency/recovery-loss-azure-region.md#virtual-machines).</span></span>

### <a name="storage-recovery"></a><span data-ttu-id="293a4-276">儲存體復原</span><span class="sxs-lookup"><span data-stu-id="293a4-276">Storage recovery</span></span>

<span data-ttu-id="293a4-277">若要保護您的儲存體發生全區域服務中斷的情況：</span><span class="sxs-lookup"><span data-stu-id="293a4-277">To protect your storage in the event of a region-wide service disruption:</span></span>

- <span data-ttu-id="293a4-278">使用異地備援儲存體。</span><span class="sxs-lookup"><span data-stu-id="293a4-278">Use geo-redundant storage.</span></span>
- <span data-ttu-id="293a4-279">知道您的儲存體的異地複寫的位置。</span><span class="sxs-lookup"><span data-stu-id="293a4-279">Know where your storage is geo-replicated.</span></span> <span data-ttu-id="293a4-280">這會影響您在其中部署您需要有您的儲存體地緣性的資料的其他執行個體。</span><span class="sxs-lookup"><span data-stu-id="293a4-280">This affects where you deploy other instances of your data that require regional affinity with your storage.</span></span>
- <span data-ttu-id="293a4-281">在容錯移轉之後會檢查資料一致性，並視需要，還原的備份。</span><span class="sxs-lookup"><span data-stu-id="293a4-281">Check data for consistency after failover and, if necessary, restore from a backup.</span></span>

<span data-ttu-id="293a4-282">若要進一步了解，請參閱[設計高可用性的應用程式使用 RA-GRS](/azure/storage/common/storage-designing-ha-apps-with-ragrs)。</span><span class="sxs-lookup"><span data-stu-id="293a4-282">To learn more, see [Designing highly available applications using RA-GRS](/azure/storage/common/storage-designing-ha-apps-with-ragrs).</span></span>

### <a name="sql-database-and-sql-server"></a><span data-ttu-id="293a4-283">SQL Database 和 SQL Server</span><span class="sxs-lookup"><span data-stu-id="293a4-283">SQL Database and SQL Server</span></span>

<span data-ttu-id="293a4-284">Azure SQL Database 提供兩種復原：</span><span class="sxs-lookup"><span data-stu-id="293a4-284">Azure SQL Database provides two types of recovery:</span></span>

- <span data-ttu-id="293a4-285">若要將資料庫從另一個區域中的備份副本還原使用異地還原。</span><span class="sxs-lookup"><span data-stu-id="293a4-285">Use geo-restore to restore a database from a backup copy in another region.</span></span> <span data-ttu-id="293a4-286">如需詳細資訊，請參閱 <<c0> [ 復原 Azure SQL database 使用自動的資料庫備份](/azure/sql-database/sql-database-recovery-using-backups)。</span><span class="sxs-lookup"><span data-stu-id="293a4-286">For more information, see [Recover an Azure SQL database using automated database backups](/azure/sql-database/sql-database-recovery-using-backups).</span></span>
- <span data-ttu-id="293a4-287">使用作用中異地複寫容錯移轉至次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="293a4-287">Use active geo-replication to fail over to a secondary database.</span></span> <span data-ttu-id="293a4-288">如需詳細資訊，請參閱 <<c0> [ 建立和使用主動式異地複寫](/azure/sql-database/sql-database-active-geo-replication)。</span><span class="sxs-lookup"><span data-stu-id="293a4-288">For more information, see [Creating and using active geo-replication](/azure/sql-database/sql-database-active-geo-replication).</span></span>

<span data-ttu-id="293a4-289">在 Vm 上執行的 SQL Server，請參閱 <<c0> [ 在 「 Azure 虛擬機器 」 中的 SQL Server 的高可用性和災害復原](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/)。</span><span class="sxs-lookup"><span data-stu-id="293a4-289">For SQL Server running on VMs, see [High availability and disaster recovery for SQL Server in Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

## <a name="service-specific-guidance"></a><span data-ttu-id="293a4-290">服務特有的指引</span><span class="sxs-lookup"><span data-stu-id="293a4-290">Service-specific guidance</span></span>

<span data-ttu-id="293a4-291">下列文章描述特定 Azure 服務的災害的復原：</span><span class="sxs-lookup"><span data-stu-id="293a4-291">The following articles describe disaster recovery for specific Azure services:</span></span>

| <span data-ttu-id="293a4-292">服務</span><span class="sxs-lookup"><span data-stu-id="293a4-292">Service</span></span>                       | <span data-ttu-id="293a4-293">文章</span><span class="sxs-lookup"><span data-stu-id="293a4-293">Article</span></span>                                                                                                                                                                                       |
|-------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="293a4-294">適用於 MySQL 的 Azure 資料庫</span><span class="sxs-lookup"><span data-stu-id="293a4-294">Azure Database for MySQL</span></span>      | [<span data-ttu-id="293a4-295">使用「適用於 MySQL 的 Azure 資料庫」的商務持續性概觀</span><span class="sxs-lookup"><span data-stu-id="293a4-295">Overview of business continuity with Azure Database for MySQL</span></span>](/azure/mysql/concepts-business-continuity)                                                  |
| <span data-ttu-id="293a4-296">適用於 PostgreSQL 的 Azure 資料庫</span><span class="sxs-lookup"><span data-stu-id="293a4-296">Azure Database for PostgreSQL</span></span> | [<span data-ttu-id="293a4-297">使用「適用於 PostgreSQL 的 Azure 資料庫」的商務持續性概觀</span><span class="sxs-lookup"><span data-stu-id="293a4-297">Overview of business continuity with Azure Database for PostgreSQL</span></span>](/azure/postgresql/concepts-business-continuity)                                        |
| <span data-ttu-id="293a4-298">Azure 雲端服務</span><span class="sxs-lookup"><span data-stu-id="293a4-298">Azure Cloud Services</span></span>          | [<span data-ttu-id="293a4-299">發生影響 Azure 雲端服務的 Azure 服務中斷事件時該怎麼辦</span><span class="sxs-lookup"><span data-stu-id="293a4-299">What to do in the event of an Azure service disruption that impacts Azure Cloud Services</span></span>](/azure/cloud-services/cloud-services-disaster-recovery-guidance) |
| <span data-ttu-id="293a4-300">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="293a4-300">Cosmos DB</span></span>                     | [<span data-ttu-id="293a4-301">使用 Azure Cosmos DB 的高可用性</span><span class="sxs-lookup"><span data-stu-id="293a4-301">High availability with Azure Cosmos DB</span></span>](/azure/cosmos-db/high-availability)                                                                                |
| <span data-ttu-id="293a4-302">Azure 金鑰保存庫</span><span class="sxs-lookup"><span data-stu-id="293a4-302">Azure Key Vault</span></span>               | [<span data-ttu-id="293a4-303">Azure Key Vault 的可用性與備援</span><span class="sxs-lookup"><span data-stu-id="293a4-303">Azure Key Vault availability and redundancy</span></span>](/azure/key-vault/key-vault-disaster-recovery-guidance)                                                        |
| <span data-ttu-id="293a4-304">Azure 儲存體</span><span class="sxs-lookup"><span data-stu-id="293a4-304">Azure Storage</span></span>                 | [<span data-ttu-id="293a4-305">Azure 儲存體中的災害復原和儲存體帳戶容錯移轉 (預覽)</span><span class="sxs-lookup"><span data-stu-id="293a4-305">Disaster recovery and storage account failover (preview) in Azure Storage</span></span>](/azure/storage/common/storage-disaster-recovery-guidance)                       |
| <span data-ttu-id="293a4-306">SQL Database</span><span class="sxs-lookup"><span data-stu-id="293a4-306">SQL Database</span></span>                  | [<span data-ttu-id="293a4-307">還原 Azure SQL Database 或容錯移轉到次要區域</span><span class="sxs-lookup"><span data-stu-id="293a4-307">Restore an Azure SQL Database or failover to a secondary region</span></span>](/azure/sql-database/sql-database-disaster-recovery)                                       |
| <span data-ttu-id="293a4-308">虛擬機器</span><span class="sxs-lookup"><span data-stu-id="293a4-308">Virtual Machines</span></span>              | [<span data-ttu-id="293a4-309">要執行 Azure 發生服務中斷的項目會影響 Azure 雲端</span><span class="sxs-lookup"><span data-stu-id="293a4-309">What to do in the event of an Azure service disruption impacts Azure Cloud</span></span>](/azure/cloud-services/cloud-services-disaster-recovery-guidance)               |
| <span data-ttu-id="293a4-310">Azure 虛擬網路</span><span class="sxs-lookup"><span data-stu-id="293a4-310">Azure Virtual Network</span></span>         | [<span data-ttu-id="293a4-311">虛擬網路 – 商務持續性</span><span class="sxs-lookup"><span data-stu-id="293a4-311">Virtual Network – Business Continuity</span></span>](/azure/virtual-network/virtual-network-disaster-recovery-guidance)                                                  |

## <a name="next-steps"></a><span data-ttu-id="293a4-312">後續步驟</span><span class="sxs-lookup"><span data-stu-id="293a4-312">Next steps</span></span>

- [<span data-ttu-id="293a4-313">從資料損毀或意外刪除復原</span><span class="sxs-lookup"><span data-stu-id="293a4-313">Recover from data corruption or accidental deletion</span></span>](../resiliency/recovery-data-corruption.md)
- [<span data-ttu-id="293a4-314">從區域全面性服務中斷復原</span><span class="sxs-lookup"><span data-stu-id="293a4-314">Recover from a region-wide service disruption</span></span>](../resiliency/recovery-loss-azure-region.md)